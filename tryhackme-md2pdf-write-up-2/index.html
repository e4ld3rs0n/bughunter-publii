<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>TryHackMe: MD2PDF write-up - bughunter.me</title><meta name="description" content="MD2PDF is a beginner-friendly TryHackMe room where we exploit a markdown-to-PDF converter vulnerability."><meta name="generator" content="Publii Open-Source CMS for Static Site"><meta name="theme-color" content="#17181E" media="(prefers-color-scheme: dark)"><meta name="theme-color" content="#D73A42" media="(prefers-color-scheme: light)"><meta name="msapplication-navbutton-color" content="#D73A42"><meta name="apple-mobile-web-app-status-bar-style" content="#D73A42"><link rel="canonical" href="https://e4ld3rs0n.github.io/bughunter-publii/tryhackme-md2pdf-write-up-2/"><link rel="alternate" type="application/atom+xml" href="https://e4ld3rs0n.github.io/bughunter-publii/feed.xml"><link rel="alternate" type="application/json" href="https://e4ld3rs0n.github.io/bughunter-publii/feed.json"><meta property="og:title" content="TryHackMe: MD2PDF write-up - bughunter.me "><meta property="og:image" content="https://e4ld3rs0n.github.io/bughunter-publii/media/posts/3/md2pdf-walkthrough.png"><meta property="og:image:width" content="900"><meta property="og:image:height" content="300"><meta property="og:site_name" content="bughunter.me"><meta property="og:description" content="MD2PDF is a beginner-friendly TryHackMe room where we exploit a markdown-to-PDF converter vulnerability."><meta property="og:url" content="https://e4ld3rs0n.github.io/bughunter-publii//tryhackme-md2pdf-write-up-2/"><meta property="og:type" content="article"><link rel="preload" href="https://e4ld3rs0n.github.io/bughunter-publii/assets/dynamic/fonts/redhatdisplay/redhatdisplay.woff2" as="font" type="font/woff2" crossorigin><link rel="preload" href="https://e4ld3rs0n.github.io/bughunter-publii/assets/dynamic/fonts/redhatdisplay/redhatdisplay-italic.woff2" as="font" type="font/woff2" crossorigin><link rel="preload" href="https://e4ld3rs0n.github.io/bughunter-publii/assets/dynamic/fonts/redhatmono/redhatmono.woff2" as="font" type="font/woff2" crossorigin><link rel="preload" href="https://e4ld3rs0n.github.io/bughunter-publii/assets/dynamic/fonts/redhatmono/redhatmono-italic.woff2" as="font" type="font/woff2" crossorigin><link rel="stylesheet" href="https://e4ld3rs0n.github.io/bughunter-publii/assets/css/style.css?v=547fc414e3f36b73498b60a767d2d398"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://e4ld3rs0n.github.io/bughunter-publii/tryhackme-md2pdf-write-up-2/"},"headline":"TryHackMe: MD2PDF write-up","datePublished":"2023-02-16T17:40+01:00","dateModified":"2025-01-27T20:32+01:00","image":{"@type":"ImageObject","url":"https://e4ld3rs0n.github.io/bughunter-publii/media/posts/3/md2pdf-walkthrough.png","height":300,"width":900},"description":"MD2PDF is a beginner-friendly TryHackMe room where we exploit a markdown-to-PDF converter vulnerability.","author":{"@type":"Person","name":"andrey","url":"https://e4ld3rs0n.github.io/bughunter-publii/authors/andrey/"},"publisher":{"@type":"Organization","name":"andrey"}}</script><noscript><style>img[loading] {
                    opacity: 1;
                }</style></noscript></head><body class="post-template"><div class="container container--center"><script data-name="BMC-Widget" data-cfasync="false" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="bughunter.me" data-description="Support me on Buy me a coffee!" data-message="" data-color="#FF813F" data-position="Right" data-x_margin="12" data-y_margin="12"></script><header class="header"><div class="header__logo"><a class="logo" href="https://e4ld3rs0n.github.io/bughunter-publii/">bughunter.me</a></div><nav class="navbar js-navbar"><button class="navbar__toggle js-toggle" aria-label="Menu" aria-haspopup="true" aria-expanded="false"><span class="navbar__toggle-box"><span class="navbar__toggle-inner">Menu</span></span></button><ul class="navbar__menu"><li><a href="https://e4ld3rs0n.github.io/bughunter-publii/tags/blog/" target="_self">blog</a></li><li><a href="https://e4ld3rs0n.github.io/bughunter-publii/tags/homelab/" target="_self">homelab</a></li><li><a href="https://e4ld3rs0n.github.io/bughunter-publii/tags/ctf/" target="_self">ctf</a></li><li><a href="https://e4ld3rs0n.github.io/bughunter-publii/about-me/" title="About this blog" target="_self">whoami</a></li><li><a href="https://e4ld3rs0n.github.io/bughunter-publii/privacy-policy/" target="_self">privacy-policy</a></li><li><a href="https://e4ld3rs0n.github.io/bughunter-publii//feed.xml" target="_self">rss-feed</a></li></ul></nav></header><main class="content"><article class="post"><header><h1 class="post__title">TryHackMe: MD2PDF write-up</h1><div class="post__meta"><time datetime="2023-02-16T17:40" class="post__date">Thursday, 16 February 2023 </time><span class="post__author"><a href="https://e4ld3rs0n.github.io/bughunter-publii/authors/andrey/" class="feed__author">andrey</a></span></div><div class="post__tags"><a href="https://e4ld3rs0n.github.io/bughunter-publii/tags/ctf/" class="invert">ctf</a> <a href="https://e4ld3rs0n.github.io/bughunter-publii/tags/tryhackme/" class="invert">tryhackme</a></div></header><figure class="post__image post__cover"><img src="https://e4ld3rs0n.github.io/bughunter-publii/media/posts/3/md2pdf-walkthrough.png" srcset="https://e4ld3rs0n.github.io/bughunter-publii/media/posts/3/responsive/md2pdf-walkthrough-xs.webp 300w, https://e4ld3rs0n.github.io/bughunter-publii/media/posts/3/responsive/md2pdf-walkthrough-sm.webp 480w, https://e4ld3rs0n.github.io/bughunter-publii/media/posts/3/responsive/md2pdf-walkthrough-md.webp 768w, https://e4ld3rs0n.github.io/bughunter-publii/media/posts/3/responsive/md2pdf-walkthrough-lg.webp 1024w" sizes="(min-width: 920px) 703px, (min-width: 700px) calc(82vw - 35px), calc(100vw - 81px)" loading="eager" height="300" width="900" alt=""></figure><div class="post__entry"><p>MD2PDF is a beginner-friendly TryHackMe room where we exploit a markdown-to-PDF converter vulnerability.</p><pre class="line-numbers language-html"><code>Link: https://tryhackme.com/room/md2pdf
Difficulty: Easy</code></pre><h2 id="enumeration">Enumeration</h2><p>To begin the enumeration process, I launched an Nmap scan, which revealed that the target machine is running three services: a standard HTTP server on port 80, an SSH server, and another HTTP server on port 5000. Additionally, the machine appears to be running some version of Ubuntu Server.<br><br>Next, I performed a Gobuster scan against both web servers, which revealed a hidden directory named “/admin” for both web services, piquing my interest.<br><br>Moving forward, I decided to explore the web applications presented to me. Both looked very similar, featuring a text box where Markdown could be entered, and a button to convert the Markdown to a PDF document.<br><br>I tried the application running on port 80 and was able to successfully generate a PDF containing my entered Markdown. However, the other application seemed to be malfunctioning as clicking the Convert button did not produce any output.<br><br>For the time being, I focused on the application running on port 80. My next course of action was to enter some HTML into the textbox to determine whether or not it would render. As expected, the HTML was rendered successfully:</p><figure class="post__image post__image--center"><img loading="lazy" src="https://e4ld3rs0n.github.io/bughunter-publii/media/posts/3/tryhackme-md2pdf-1.png" height="542" width="960" alt="" sizes="(min-width: 920px) 703px, (min-width: 700px) calc(82vw - 35px), calc(100vw - 81px)" srcset="https://e4ld3rs0n.github.io/bughunter-publii/media/posts/3/responsive/tryhackme-md2pdf-1-xs.webp 300w, https://e4ld3rs0n.github.io/bughunter-publii/media/posts/3/responsive/tryhackme-md2pdf-1-sm.webp 480w, https://e4ld3rs0n.github.io/bughunter-publii/media/posts/3/responsive/tryhackme-md2pdf-1-md.webp 768w, https://e4ld3rs0n.github.io/bughunter-publii/media/posts/3/responsive/tryhackme-md2pdf-1-lg.webp 1024w"></figure><figure class="post__image post__image--center"><img loading="lazy" src="https://e4ld3rs0n.github.io/bughunter-publii/media/posts/3/tryhackme-md2pdf-2.png" height="621" width="960" alt="" sizes="(min-width: 920px) 703px, (min-width: 700px) calc(82vw - 35px), calc(100vw - 81px)" srcset="https://e4ld3rs0n.github.io/bughunter-publii/media/posts/3/responsive/tryhackme-md2pdf-2-xs.webp 300w, https://e4ld3rs0n.github.io/bughunter-publii/media/posts/3/responsive/tryhackme-md2pdf-2-sm.webp 480w, https://e4ld3rs0n.github.io/bughunter-publii/media/posts/3/responsive/tryhackme-md2pdf-2-md.webp 768w, https://e4ld3rs0n.github.io/bughunter-publii/media/posts/3/responsive/tryhackme-md2pdf-2-lg.webp 1024w"></figure><p>The /admin directory for both applications displayed a “Forbidden” error:<br></p><pre class="line-numbers language-html"><code>Forbidden

This page can only be seen internally (localhost:5000)</code></pre><h2 id="exploit">Exploit</h2><p>Since we already knew that the PDF document could render HTML, I had an idea to try and get a sneak peek of what the /admin directory looks like. I thought maybe embedding it into an iframe could do the trick:</p><pre class="line-numbers language-html"><code>&lt;iframe src="http://localhost/admin" width="800" height="800"&gt;&lt;/iframe&gt;</code></pre><p>That did not work however:</p><figure class="post__image post__image--center"><img loading="lazy" src="https://e4ld3rs0n.github.io/bughunter-publii/media/posts/3/tryhackme-md2pdf-3.png" height="338" width="768" alt="" sizes="(min-width: 920px) 703px, (min-width: 700px) calc(82vw - 35px), calc(100vw - 81px)" srcset="https://e4ld3rs0n.github.io/bughunter-publii/media/posts/3/responsive/tryhackme-md2pdf-3-xs.webp 300w, https://e4ld3rs0n.github.io/bughunter-publii/media/posts/3/responsive/tryhackme-md2pdf-3-sm.webp 480w, https://e4ld3rs0n.github.io/bughunter-publii/media/posts/3/responsive/tryhackme-md2pdf-3-md.webp 768w, https://e4ld3rs0n.github.io/bughunter-publii/media/posts/3/responsive/tryhackme-md2pdf-3-lg.webp 1024w"></figure><p>Maybe we can view the /admin directory on the other port?</p><pre class="line-numbers language-html"><code>&lt;iframe src="http://localhost:5000/admin" width="800" height="800"&gt;&lt;/iframe&gt;</code></pre><p>That does the trick and we are rewarded with the flag:</p><figure class="post__image post__image--center"><img loading="lazy" src="https://e4ld3rs0n.github.io/bughunter-publii/media/posts/3/tryhackme-md2pdf-4.png" height="287" width="768" alt="" sizes="(min-width: 920px) 703px, (min-width: 700px) calc(82vw - 35px), calc(100vw - 81px)" srcset="https://e4ld3rs0n.github.io/bughunter-publii/media/posts/3/responsive/tryhackme-md2pdf-4-xs.webp 300w, https://e4ld3rs0n.github.io/bughunter-publii/media/posts/3/responsive/tryhackme-md2pdf-4-sm.webp 480w, https://e4ld3rs0n.github.io/bughunter-publii/media/posts/3/responsive/tryhackme-md2pdf-4-md.webp 768w, https://e4ld3rs0n.github.io/bughunter-publii/media/posts/3/responsive/tryhackme-md2pdf-4-lg.webp 1024w"></figure><p></p></div><footer class="wrapper post__footer"><p class="post__last-updated">This article was updated on Monday, 27 January 2025</p><div class="post__share"><a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fe4ld3rs0n.github.io%2Fbughunter-publii%2Ftryhackme-md2pdf-write-up-2%2F" class="js-share invert facebook" rel="nofollow noopener noreferrer"><svg class="icon" aria-hidden="true" focusable="false"><use xlink:href="https://e4ld3rs0n.github.io/bughunter-publii/assets/svg/svg-map.svg#facebook"/></svg> <span>Facebook</span> </a><a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fe4ld3rs0n.github.io%2Fbughunter-publii%2Ftryhackme-md2pdf-write-up-2%2F" class="js-share invert linkedin" rel="nofollow noopener noreferrer"><svg class="icon" aria-hidden="true" focusable="false"><use xlink:href="https://e4ld3rs0n.github.io/bughunter-publii/assets/svg/svg-map.svg#linkedin"/></svg> <span>LinkedIn</span> </a><a href="https://buffer.com/add?text=TryHackMe%3A%20MD2PDF%20write-up&amp;url=https%3A%2F%2Fe4ld3rs0n.github.io%2Fbughunter-publii%2Ftryhackme-md2pdf-write-up-2%2F" class="js-share invert buffer" rel="nofollow noopener noreferrer"><svg class="icon" aria-hidden="true" focusable="false"><use xlink:href="https://e4ld3rs0n.github.io/bughunter-publii/assets/svg/svg-map.svg#buffer"/></svg> <span>Buffer</span> </a><a href="https://api.whatsapp.com/send?text=TryHackMe%3A%20MD2PDF%20write-up https%3A%2F%2Fe4ld3rs0n.github.io%2Fbughunter-publii%2Ftryhackme-md2pdf-write-up-2%2F" class="js-share invert whatsapp" rel="nofollow noopener noreferrer"><svg class="icon" aria-hidden="true" focusable="false"><use xlink:href="https://e4ld3rs0n.github.io/bughunter-publii/assets/svg/svg-map.svg#whatsapp"/></svg> <span>WhatsApp</span></a></div></footer><nav class="pagination"><div class="pagination__title"><span>Read other posts</span></div><div class="pagination__buttons"><a href="https://e4ld3rs0n.github.io/bughunter-publii/tryhackme-eavesdropper-write-up/" class="btn next" rel="next" aria-label="[MISSING TRANSLATION]:  TryHackMe: Eavesdropper write-up "><span class="btn__text">TryHackMe: Eavesdropper write-up</span> <span class="btn__icon">→</span></a></div></nav></article><div class="post__comments"></div></main><footer class="footer"><div class="footer__inner"><div class="footer__copyright"><p>© 2023 - 2025 BugHunter</p></div></div></footer></div><script defer="defer" src="https://e4ld3rs0n.github.io/bughunter-publii/assets/js/scripts.min.js?v=c2232aa7558e9517946129d2a1b8c770"></script><script>window.publiiThemeMenuConfig={mobileMenuMode:'overlay',animationSpeed:300,submenuWidth: 'auto',doubleClickTime:500,mobileMenuExpandableSubmenus:true,relatedContainerForOverlayMenuSelector:'.top'};</script><script>var images = document.querySelectorAll('img[loading]');
        for (var i = 0; i < images.length; i++) {
            if (images[i].complete) {
                images[i].classList.add('is-loaded');
            } else {
                images[i].addEventListener('load', function () {
                    this.classList.add('is-loaded');
                }, false);
            }
        }</script><script>'use strict'; document.addEventListener('DOMContentLoaded', function() { var obfElements = document.querySelectorAll('.obfuscated-email'); obfElements.forEach(function(elem) { var dataType = elem.getAttribute('data-type'); var encodedEmail = elem.getAttribute('data-email'); var user = elem.getAttribute('data-user'); var domain = elem.getAttribute('data-domain'); var decodedEmail = ''; if (user && domain) { decodedEmail = user.split('').reverse().join('') + '@' + domain.split('').reverse().join(''); } else if (encodedEmail) { const parts = encodedEmail.split('@'); if (parts.length === 2) { decodedEmail = parts[0].split('').reverse().join('') + '@' + parts[1].split('').reverse().join(''); } else { decodedEmail = encodedEmail; } } if (dataType === 'mailto') { var originalText = elem.textContent.trim(); var a = document.createElement('a'); a.href = 'mailto:' + decodedEmail; if (elem.classList.length > 0) { a.className = elem.className; } if (originalText === '') { a.textContent = decodedEmail; } else { a.textContent = originalText; } elem.parentNode.replaceChild(a, elem); } else if (dataType === 'text') { var textNode = document.createTextNode(decodedEmail); elem.parentNode.replaceChild(textNode, elem); } }); });</script></body></html>