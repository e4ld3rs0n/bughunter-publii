<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>TryHackMe: MD2PDF write-up - bughunter.me</title><meta name="description" content="In this article we are going to explore the solution to TryHackMe's MD2PDF and exploit a Markdown converter. Link: https://tryhackme.com/room/md2pdf Difficulty: Easy To begin the&hellip;"><meta name="generator" content="Publii Open-Source CMS for Static Site"><meta name="theme-color" content="#17181E" media="(prefers-color-scheme: dark)"><meta name="theme-color" content="#D73A42" media="(prefers-color-scheme: light)"><meta name="msapplication-navbutton-color" content="#D73A42"><meta name="apple-mobile-web-app-status-bar-style" content="#D73A42"><link rel="canonical" href="https://e4ld3rs0n.github.io/bughunter-publii/tryhackme-md2pdf-write-up-3/"><link rel="alternate" type="application/atom+xml" href="https://e4ld3rs0n.github.io/bughunter-publii/feed.xml"><link rel="alternate" type="application/json" href="https://e4ld3rs0n.github.io/bughunter-publii/feed.json"><meta property="og:title" content="TryHackMe: MD2PDF write-up"><meta property="og:image" content="https://e4ld3rs0n.github.io/bughunter-publii/media/posts/11/tryhackme-banner.jpg"><meta property="og:image:width" content="800"><meta property="og:image:height" content="440"><meta property="og:site_name" content="bughunter.me"><meta property="og:description" content="In this article we are going to explore the solution to TryHackMe's MD2PDF and exploit a Markdown converter. Link: https://tryhackme.com/room/md2pdf Difficulty: Easy To begin the&hellip;"><meta property="og:url" content="https://e4ld3rs0n.github.io/bughunter-publii//tryhackme-md2pdf-write-up-3/"><meta property="og:type" content="article"><link rel="preload" href="https://e4ld3rs0n.github.io/bughunter-publii/assets/dynamic/fonts/redhatmono/redhatmono.woff2" as="font" type="font/woff2" crossorigin><link rel="preload" href="https://e4ld3rs0n.github.io/bughunter-publii/assets/dynamic/fonts/redhatmono/redhatmono-italic.woff2" as="font" type="font/woff2" crossorigin><link rel="stylesheet" href="https://e4ld3rs0n.github.io/bughunter-publii/assets/css/style.css?v=7fa218a425dbbcb21ada335c561af1e5"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://e4ld3rs0n.github.io/bughunter-publii/tryhackme-md2pdf-write-up-3/"},"headline":"TryHackMe: MD2PDF write-up","datePublished":"2023-02-16T16:45+01:00","dateModified":"2025-01-26T18:11+01:00","image":{"@type":"ImageObject","url":"https://e4ld3rs0n.github.io/bughunter-publii/media/posts/11/tryhackme-banner.jpg","height":440,"width":800},"description":"In this article we are going to explore the solution to TryHackMe's MD2PDF and exploit a Markdown converter. Link: https://tryhackme.com/room/md2pdf Difficulty: Easy To begin the&hellip;","author":{"@type":"Person","name":"andrey","url":"https://e4ld3rs0n.github.io/bughunter-publii/authors/andrey/"},"publisher":{"@type":"Organization","name":"andrey"}}</script><noscript><style>img[loading] {
                    opacity: 1;
                }</style></noscript></head><body class="post-template"><div class="container container--center"><header class="header"><div class="header__logo"><a class="logo" href="https://e4ld3rs0n.github.io/bughunter-publii/">bughunter.me</a></div><nav class="navbar js-navbar"><button class="navbar__toggle js-toggle" aria-label="Menu" aria-haspopup="true" aria-expanded="false"><span class="navbar__toggle-box"><span class="navbar__toggle-inner">Menu</span></span></button><ul class="navbar__menu"><li><a href="https://e4ld3rs0n.github.io/bughunter-publii/tags/blog/" target="_self">blog</a></li><li><a href="https://e4ld3rs0n.github.io/bughunter-publii/tags/ctf/" target="_self">ctf</a></li><li><a href="https://e4ld3rs0n.github.io/bughunter-publii/about-me/" title="About this blog" target="_self">whoami</a></li></ul></nav></header><main class="content"><article class="post"><header><h1 class="post__title">TryHackMe: MD2PDF write-up</h1><div class="post__meta"><time datetime="2023-02-16T16:45" class="post__date">Thursday, 16 February 2023 </time><span class="post__author"><a href="https://e4ld3rs0n.github.io/bughunter-publii/authors/andrey/" class="feed__author">andrey</a></span></div><div class="post__tags"><a href="https://e4ld3rs0n.github.io/bughunter-publii/tags/ctf/" class="invert">ctf</a> <a href="https://e4ld3rs0n.github.io/bughunter-publii/tags/tryhackme/" class="invert">tryhackme</a></div></header><figure class="post__image post__cover"><img src="https://e4ld3rs0n.github.io/bughunter-publii/media/posts/11/tryhackme-banner.jpg" srcset="https://e4ld3rs0n.github.io/bughunter-publii/media/posts/11/responsive/tryhackme-banner-xs.jpg 300w, https://e4ld3rs0n.github.io/bughunter-publii/media/posts/11/responsive/tryhackme-banner-sm.jpg 480w, https://e4ld3rs0n.github.io/bughunter-publii/media/posts/11/responsive/tryhackme-banner-md.jpg 768w, https://e4ld3rs0n.github.io/bughunter-publii/media/posts/11/responsive/tryhackme-banner-lg.jpg 1024w" sizes="(min-width: 920px) 703px, (min-width: 700px) calc(82vw - 35px), calc(100vw - 81px)" loading="eager" height="440" width="800" alt=""></figure><div class="post__entry"><p></p><p>In this article we are going to explore the solution to TryHackMe's MD2PDF and exploit a Markdown converter.</p><p></p><p></p><p>Link: <a href="https://tryhackme.com/room/md2pdf" target="_blank" rel="noopener">https://tryhackme.com/room/md2pdf</a></p><p></p><p></p><p>Difficulty: <code>Easy</code></p><p></p><p></p><h2 class="wp-block-heading">Enumeration</h2><p></p><p></p><p>To begin the enumeration process, I launched an Nmap scan, which revealed that the target machine is running three services: a standard HTTP server on port 80, an SSH server, and another HTTP server on port 5000. Additionally, the machine appears to be running some version of Ubuntu Server.</p><p></p><p></p><p>Next, I performed a Gobuster scan against both web servers, which revealed a hidden directory named "/admin" for both web services, piquing my interest.</p><p></p><p></p><p>Moving forward, I decided to explore the web applications presented to me. Both looked very similar, featuring a text box where Markdown could be entered, and a button to convert the Markdown to a PDF document.</p><p></p><p></p><p>I tried the application running on port 80 and was able to successfully generate a PDF containing my entered Markdown. However, the other application seemed to be malfunctioning as clicking the Convert button did not produce any output.</p><p></p><p></p><p>For the time being, I focused on the application running on port 80. My next course of action was to enter some HTML into the textbox to determine whether or not it would render. As expected, the HTML was rendered successfully:</p><p></p><p></p><figure class="wp-block-image size-full"><figure class="wp-image-150"><img loading="lazy" src="https://e4ld3rs0n.github.io/bughunter-publii/media/posts/11/tryhackme-md2pdf-1.png" alt="" sizes="(min-width: 920px) 703px, (min-width: 700px) calc(82vw - 35px), calc(100vw - 81px)" srcset="https://e4ld3rs0n.github.io/bughunter-publii/media/posts/11/responsive/tryhackme-md2pdf-1-xs.png 300w, https://e4ld3rs0n.github.io/bughunter-publii/media/posts/11/responsive/tryhackme-md2pdf-1-sm.png 480w, https://e4ld3rs0n.github.io/bughunter-publii/media/posts/11/responsive/tryhackme-md2pdf-1-md.png 768w, https://e4ld3rs0n.github.io/bughunter-publii/media/posts/11/responsive/tryhackme-md2pdf-1-lg.png 1024w"></figure></figure><p></p><p></p><figure class="wp-block-image size-full"><figure class="wp-image-151"><img loading="lazy" src="https://e4ld3rs0n.github.io/bughunter-publii/media/posts/11/tryhackme-md2pdf-2.png" alt="" sizes="(min-width: 920px) 703px, (min-width: 700px) calc(82vw - 35px), calc(100vw - 81px)" srcset="https://e4ld3rs0n.github.io/bughunter-publii/media/posts/11/responsive/tryhackme-md2pdf-2-xs.png 300w, https://e4ld3rs0n.github.io/bughunter-publii/media/posts/11/responsive/tryhackme-md2pdf-2-sm.png 480w, https://e4ld3rs0n.github.io/bughunter-publii/media/posts/11/responsive/tryhackme-md2pdf-2-md.png 768w, https://e4ld3rs0n.github.io/bughunter-publii/media/posts/11/responsive/tryhackme-md2pdf-2-lg.png 1024w"></figure></figure><p></p><p></p><p>The /admin directory for both applications displayed a "Forbidden" error:</p><p></p><p></p><pre class="EnlighterJSRAW" data-enlighter-language="generic" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">ForbiddenThis page can only be seen internally (localhost:5000)</pre><p></p><p></p><h2 class="wp-block-heading">Exploit</h2><p></p><p></p><p>Since we already knew that the PDF document could render HTML, I had an idea to try and get a sneak peek of what the /admin directory looks like. I thought maybe embedding it into an iframe could do the trick:</p><p></p><p></p><pre class="EnlighterJSRAW" data-enlighter-language="generic" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">&lt;iframe src="http://localhost/admin" width="800" height="800"&gt;&lt;/iframe&gt;</pre><p></p><p></p><p>That did not work however:</p><p></p><p></p><figure class="wp-block-image size-full"><figure class="wp-image-153"><img loading="lazy" src="https://e4ld3rs0n.github.io/bughunter-publii/media/posts/11/tryhackme-md2pdf-3.png" alt="" sizes="(min-width: 920px) 703px, (min-width: 700px) calc(82vw - 35px), calc(100vw - 81px)" srcset="https://e4ld3rs0n.github.io/bughunter-publii/media/posts/11/responsive/tryhackme-md2pdf-3-xs.png 300w, https://e4ld3rs0n.github.io/bughunter-publii/media/posts/11/responsive/tryhackme-md2pdf-3-sm.png 480w, https://e4ld3rs0n.github.io/bughunter-publii/media/posts/11/responsive/tryhackme-md2pdf-3-md.png 768w, https://e4ld3rs0n.github.io/bughunter-publii/media/posts/11/responsive/tryhackme-md2pdf-3-lg.png 1024w"></figure></figure><p></p><p></p><p>Hm, that did not work. Maybe we can view the /admin directory on the other port?</p><p></p><p></p><pre class="EnlighterJSRAW" data-enlighter-language="generic" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">&lt;iframe src="http://localhost:5000/admin" width="800" height="800"&gt;&lt;/iframe&gt;</pre><p></p><p></p><p>That does the trick and we are rewarded with the flag:</p><p></p><p></p><figure class="wp-block-image size-full"><figure class="wp-image-154"><img loading="lazy" src="https://e4ld3rs0n.github.io/bughunter-publii/media/posts/11/tryhackme-md2pdf-4.png" alt="" sizes="(min-width: 920px) 703px, (min-width: 700px) calc(82vw - 35px), calc(100vw - 81px)" srcset="https://e4ld3rs0n.github.io/bughunter-publii/media/posts/11/responsive/tryhackme-md2pdf-4-xs.png 300w, https://e4ld3rs0n.github.io/bughunter-publii/media/posts/11/responsive/tryhackme-md2pdf-4-sm.png 480w, https://e4ld3rs0n.github.io/bughunter-publii/media/posts/11/responsive/tryhackme-md2pdf-4-md.png 768w, https://e4ld3rs0n.github.io/bughunter-publii/media/posts/11/responsive/tryhackme-md2pdf-4-lg.png 1024w"></figure></figure><p></p></div><footer class="wrapper post__footer"><p class="post__last-updated">This article was updated on Sunday, 26 January 2025</p><div class="post__share"><a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fe4ld3rs0n.github.io%2Fbughunter-publii%2Ftryhackme-md2pdf-write-up-3%2F" class="js-share invert facebook" rel="nofollow noopener noreferrer"><svg class="icon" aria-hidden="true" focusable="false"><use xlink:href="https://e4ld3rs0n.github.io/bughunter-publii/assets/svg/svg-map.svg#facebook"/></svg> <span>Facebook</span> </a><a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fe4ld3rs0n.github.io%2Fbughunter-publii%2Ftryhackme-md2pdf-write-up-3%2F" class="js-share invert linkedin" rel="nofollow noopener noreferrer"><svg class="icon" aria-hidden="true" focusable="false"><use xlink:href="https://e4ld3rs0n.github.io/bughunter-publii/assets/svg/svg-map.svg#linkedin"/></svg> <span>LinkedIn</span> </a><a href="https://api.whatsapp.com/send?text=TryHackMe%3A%20MD2PDF%20write-up https%3A%2F%2Fe4ld3rs0n.github.io%2Fbughunter-publii%2Ftryhackme-md2pdf-write-up-3%2F" class="js-share invert whatsapp" rel="nofollow noopener noreferrer"><svg class="icon" aria-hidden="true" focusable="false"><use xlink:href="https://e4ld3rs0n.github.io/bughunter-publii/assets/svg/svg-map.svg#whatsapp"/></svg> <span>WhatsApp</span></a></div></footer><nav class="pagination"><div class="pagination__title"><span>Read other posts</span></div><div class="pagination__buttons"><a href="https://e4ld3rs0n.github.io/bughunter-publii/tryhackme-md2pdf-write-up-2/" class="btn next" rel="next" aria-label="[MISSING TRANSLATION]:  TryHackMe: MD2PDF write-up "><span class="btn__text">TryHackMe: MD2PDF write-up</span> <span class="btn__icon">→</span></a></div></nav></article><div class="post__comments"><div class="comments"><div class="comments-wrapper"><h2>Comments</h2><div id="commento"></div><noscript>Please enable JS to use the comments form.</noscript><script type="text/javascript">var commento_element_to_check = document.getElementById('commento');

				if ('IntersectionObserver' in window) {
					var iObserver = new IntersectionObserver(
						(entries, observer) => {
							entries.forEach(entry => {
								if (entry.intersectionRatio >= 0.1) {
									(function () {
										var d = document, s = d.createElement('script');
										s.defer = true;
										s.setAttribute('data-no-fonts','true');
										s.setAttribute('data-page-id','11');
										s.setAttribute('data-hide-deleted','false');
										s.src = 'https://cdn.commento.io/js/commento.js';									
										(d.head || d.body).appendChild(s);
									})();
									observer.unobserve(entry.target);
								}
							});
						},
						{
							threshold: [0, 0.2, 0.5, 1]
						}
					);

					iObserver.observe(commento_element_to_check);
				} else {
					(function () {
						var d = document, s = d.createElement('script');
						s.defer = true;
						s.setAttribute('data-no-fonts','true');
						s.setAttribute('data-page-id','11');
						s.setAttribute('data-hide-deleted','false');
						s.src = 'https://cdn.commento.io/js/commento.js';
						(d.head || d.body).appendChild(s);
					})();
				}</script><script type="text/javascript"></script></div></div></div></main><footer class="footer"><div class="footer__inner"><div class="footer__copyright"><p>© 2023 - 2025 BugHunter</p></div></div></footer></div><script defer="defer" src="https://e4ld3rs0n.github.io/bughunter-publii/assets/js/scripts.min.js?v=c2232aa7558e9517946129d2a1b8c770"></script><script>window.publiiThemeMenuConfig={mobileMenuMode:'overlay',animationSpeed:300,submenuWidth: 'auto',doubleClickTime:500,mobileMenuExpandableSubmenus:true,relatedContainerForOverlayMenuSelector:'.top'};</script><script>var images = document.querySelectorAll('img[loading]');
        for (var i = 0; i < images.length; i++) {
            if (images[i].complete) {
                images[i].classList.add('is-loaded');
            } else {
                images[i].addEventListener('load', function () {
                    this.classList.add('is-loaded');
                }, false);
            }
        }</script><script>class Rot18Encoder { constructor() { this.rotations = [ { from: 'a', to: 'z', offset: 18 }, { from: 'A', to: 'Z', offset: 18 }, { from: '0', to: '9', offset: 5 } ]; } _rotate(char, from, to, offset) { const charCode = char.charCodeAt(0); const fromCode = from.charCodeAt(0); const toCode = to.charCodeAt(0); const range = toCode - fromCode + 1; if (charCode >= fromCode && charCode <= toCode) { const shiftedCode = ((charCode - fromCode + offset) % range) + fromCode; return String.fromCharCode(shiftedCode); } return char; } encode(text) { let encodedText = ""; for(let char of text){ let rotatedChar = char; for (const rot of this.rotations){ rotatedChar = this._rotate(rotatedChar, rot.from, rot.to, rot.offset); } encodedText += rotatedChar; } return encodedText; } decode(text) { let decodedText = ""; for(let char of text){ let rotatedChar = char; for (const rot of this.rotations){ rotatedChar = this._rotate(rotatedChar, rot.from, rot.to, rot.to.charCodeAt(0) - rot.from.charCodeAt(0) + 1 - rot.offset); } decodedText += rotatedChar; } return decodedText; } } class TextProcessor { constructor(encoder){ this.encoder = encoder; } encode(text){ return this.encoder.encode(text); } decode(text){ return this.encoder.decode(text); } } document.addEventListener('DOMContentLoaded', function() { const rot18 = new Rot18Encoder(); const coder = new TextProcessor(rot18); var obfElements = document.querySelectorAll('.obfuscated-email'); obfElements.forEach(function(elem) { var dataType = elem.getAttribute('data-type'); var encodedEmail = elem.getAttribute('data-email'); var user = elem.getAttribute('data-user'); var domain = elem.getAttribute('data-domain'); var decodedEmail = ''; if (user && domain) { decodedEmail = coder.decode(user) + '@' + coder.decode(domain); } else if (encodedEmail) { const parts = encodedEmail.split('@'); if (parts.length === 2) { decodedEmail = coder.decode(parts[0]) + '@' + coder.decode(parts[1]); } else { decodedEmail = encodedEmail; } } if (dataType === 'mailto') { var originalText = elem.textContent.trim(); var a = document.createElement('a'); a.href = 'mailto:' + decodedEmail; if (elem.classList.length > 0) { a.className = elem.className; } if (originalText === '') { a.textContent = decodedEmail; } else { a.textContent = originalText; } elem.parentNode.replaceChild(a, elem); } else if (dataType === 'text') { var textNode = document.createTextNode(decodedEmail); elem.parentNode.replaceChild(textNode, elem); } }); });</script></body></html>